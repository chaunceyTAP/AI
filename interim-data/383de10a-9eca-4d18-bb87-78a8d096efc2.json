{"guid":"383de10a-9eca-4d18-bb87-78a8d096efc2","title":"Generate personalized PDF documents","path":"help\\delivery\\using\\generating-personalized-pdf-documents.md","fullText":"---\nproduct: campaign\ntitle: Generate personalized PDF documents\ndescription: Learn how to generate personalized PDF documents\nbadge-v8: label=\"Also applies to v8\" type=\"Positive\" tooltip=\"Also applies to Campaign v8\"\nfeature: Personalization\nrole: User\nexl-id: e5239d99-256b-412b-be20-f64f822da9c3\n---\n# Generate personalized PDF documents{#generating-personalized-pdf-documents}\n\n## About variable PDF documents {#about-variable-pdf-documents}\n\nAdobe Campaign lets you generate variable PDF documents for email attachments from LibreOffice or Microsoft Word documents.\n\nThe following extensions are supported: \".docx\", \".doc\", and \".odt\".\n\nTo personalize your documents, the same JavaScript functionalities as for email personalization are available.\n\nYou need to activate the **[!UICONTROL \"The content of the file is personalized and converted to PDF during the delivery of each message\"]** option. This option is accessible when you attach the file to the delivery email. For more on attaching a calculated file, refer to the [Attach files](attaching-files.md) section.\n\nExample of an invoice header personalization:\n\n![](assets/s_ncs_pdf_simple.png)\n\nTo generate dynamic tables or include images via a URL, you need to follow a specific process.\n\n## Generate dynamic tables {#generating-dynamic-tables}\n\nThe procedure for generating dynamic tables is as follows:\n\n* Create a table with three lines and as many columns as necessary, then configure its layout (borders, etc.).\n* Place your cursor on the table and click the **[!UICONTROL Table > Table properties]** menu. Go to the **[!UICONTROL Table]** tab and enter a name beginning with **NlJsTable**.\n* In the first cell of the first line, define a loop (\"for\", for example) that enables iteration on the values you want to display in the table.\n* In each cell of the second line of the table, insert scripts that return the values to display.\n* Close the loop in the third and last line of the table.\n\n  Example of a dynamic table definition:\n\n  ![](assets/s_ncs_pdf_table.png)\n\n## Insert external images {#inserting-external-images}\n\nThe insertion of external images is useful if, for instance, you want to personalize a document with an image whose URL is entered in a field of the recipient.\n\nTo do this, you need to configure a personalization block, then include a call to the personalization block in the attachment.\n\n**Example: insert a personalized logo depending on the recipient's country**\n\n**Step 1: create the attachment:**\n\n* Insert the call to the personalization block: **<%@ include view=\"blockname\" %>**.\n* Insert your content (personalized or not) into the body of the file.\n\n![](assets/s_ncs_open_office_blocdeperso.png)\n\n**Step 2: create the personalization block:**\n\n* Go to the **[!UICONTROL Resources > Campaign management > Personalization blocks]** menu of the Adobe Campaign console.\n* Create a new \"My Logo\" personalization block with \"My_Logo\" as an internal name.\n* Click on the **[!UICONTROL Advanced parameters...]** link then check the **[!UICONTROL \"The content of the block is included in an attachment\"]** option. This lets you copy the definition of the personalization block directly into the content of the OpenOffice file.\n\n  ![](assets/s_ncs_pdf_bloc_option.png)\n\n  You need to differentiate two types of declarations within the personalization block:\n\n  * The Adobe Campaign code of the personalization fields for which the \"open\" and \"closed\" chevrons must be replaced with escape characters (respectively `&lt;` and `&gt;`).\n  * The entire OpenOffice XML code will be copied into the OpenOffice document.\n\nIn the example, the personalization block looks like this:\n\n```\n<% if (recipient.country.label == \"Germany\") { %>\n<draw:frame svg:width=\"4cm\" svg:height=\"3cm\">\n<draw:image xlink:href=https://..../logo_germany.png />\n</draw:frame>\n<% } else\nif (recipient.country.label == \"USA\")\n{ %>\n<draw:frame svg:width=\"4cm\" svg:height=\"3cm\">\n<draw:image xlink:href=https://..../logo_USA.png />\n</draw:frame>\n<% } %>\n```\n\nDepending on the recipient's country, personalization is visible in the document linked to the delivery:\n\n![](assets/s_ncs_pdf_result.png)\n","headers":[["title","Generate personalized PDF documents"],["description","Learn how to generate personalized PDF documents"],["feature","Personalization"]],"sections":[{"section":"Generate personalized PDF documents","sectionId":"10b501ac-83a3-405e-b06d-bc4f00f2631b","paragraphs":[]},{"section":"About variable PDF documents","sectionId":"075c31b8-457b-4cc1-851a-b587d984007f","paragraphs":["Adobe Campaign lets you generate variable PDF documents for email attachments from LibreOffice or Microsoft Word documents.","The following extensions are supported: \".docx\", \".doc\", and \".odt\".","To personalize your documents, the same JavaScript functionalities as for email personalization are available.","You need to activate the \"The content of the file is personalized and converted to PDF during the delivery of each message\" option. This option is accessible when you attach the file to the delivery email. For more on attaching a calculated file, refer to the Attach files section.","Example of an invoice header personalization:","To generate dynamic tables or include images via a URL, you need to follow a specific process."]},{"section":"Generate dynamic tables","sectionId":"fe07fb18-8e39-4b69-82b6-c0de66f97188","paragraphs":["The procedure for generating dynamic tables is as follows:","Create a table with three lines and as many columns as necessary, then configure its layout (borders, etc.).","Place your cursor on the table and click the Table > Table properties menu. Go to the Table tab and enter a name beginning with NlJsTable.","In the first cell of the first line, define a loop (\"for\", for example) that enables iteration on the values you want to display in the table.","In each cell of the second line of the table, insert scripts that return the values to display.","Close the loop in the third and last line of the table.","Example of a dynamic table definition:"]},{"section":"Insert external images","sectionId":"4fc63368-951f-4d22-ac32-5c5a1397af6b","paragraphs":["The insertion of external images is useful if, for instance, you want to personalize a document with an image whose URL is entered in a field of the recipient.","To do this, you need to configure a personalization block, then include a call to the personalization block in the attachment.","Example: insert a personalized logo depending on the recipient's country","Step 1: create the attachment:","Insert the call to the personalization block: <%@ include view=\"blockname\" %>.\nInsert your content (personalized or not) into the body of the file.","Step 2: create the personalization block:","Go to the Resources > Campaign management > Personalization blocks menu of the Adobe Campaign console.","Create a new \"My Logo\" personalization block with \"My_Logo\" as an internal name.","Click on the Advanced parameters... link then check the \"The content of the block is included in an attachment\" option. This lets you copy the definition of the personalization block directly into the content of the OpenOffice file.","You need to differentiate two types of declarations within the personalization block:","The Adobe Campaign code of the personalization fields for which the \"open\" and \"closed\" chevrons must be replaced with escape characters (respectively &lt; and &gt;).\nThe entire OpenOffice XML code will be copied into the OpenOffice document.","In the example, the personalization block looks like this:","<% if (recipient.country.label == \"Germany\") { %>\n<draw:frame svg:width=\"4cm\" svg:height=\"3cm\">\n<draw:image xlink:href=https://..../logo_germany.png />\n</draw:frame>\n<% } else\nif (recipient.country.label == \"USA\")\n{ %>\n<draw:frame svg:width=\"4cm\" svg:height=\"3cm\">\n<draw:image xlink:href=https://..../logo_USA.png />\n</draw:frame>\n<% } %>","Depending on the recipient's country, personalization is visible in the document linked to the delivery:"]}]}