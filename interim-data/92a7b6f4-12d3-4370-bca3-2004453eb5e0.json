{"guid":"92a7b6f4-12d3-4370-bca3-2004453eb5e0","title":"Send a birthday email","path":"help\\workflow\\using\\sending-a-birthday-email.md","fullText":"---\nproduct: campaign\ntitle: Send a birthday email\ndescription: Learn how to send a birthday email with a workflow\nfeature: Workflows\nexl-id: 38006cca-e945-4b9d-8e2d-ed537b8541d9\n---\n# Send a birthday email{#sending-a-birthday-email}\n\n\n\n## Introduction {#introduction}\n\nThis use case presents how to plan sending a recurring email to a list of recipients on the day of their birthday.\n\nTo set up this use case, we created the following targeting workflow:\n\n![](assets/birthday-workflow_usecase_1.png)\n\nThis (daily run) workflow selects all recipients that have their birthday on the current date.\n\n![](assets/do-not-localize/how-to-video.png) This use case can also be found in the form of a video. For more on this, refer to the [Creating a workflow](https://experienceleague.adobe.com/docs/campaign-classic-learn/tutorials/automating-with-workflows/creating-a-workflow.html) video.\n\nTo do this, create a campaign and click the **[!UICONTROL Targeting and workflows]** tab. For more on this, refer to the [Building the main target in a workflow](../../campaign/using/marketing-campaign-deliveries.md#building-the-main-target-in-a-workflow) section.\n\nThen follow these steps:\n\n## Scheduling the sending {#configuring-the-scheduler}\n\n1. First, add a **Scheduler** to trigger sending the delivery every day. In the example below, the delivery is created every day at 6am.\n\n   ![](assets/recur_delivery2.png)\n\n\n## Identifying recipients whose birthday it is {#identifying-recipients-whose-birthday-it-is}\n\nAfter configuring the **[!UICONTROL Scheduler]** activity so that the workflow starts every day, identify all of the recipients whose date of birth equals the current date.\n\nTo do this, apply the following steps:\n\n1. Drag and drop a **[!UICONTROL Query]** activity into the workflow and double-click it.\n1. Click the **Edit query** link and select **[!UICONTROL Filtering conditions]**.\n\n   ![](assets/s_ncs_user_create_exp_exple00.png)\n\n1. Click the first cell of the **[!UICONTROL Expression]** column and click **[!UICONTROL Edit expression]** to open the expression editor.\n\n   ![](assets/s_ncs_user_create_exp_exple.png)\n\n1. Click **[!UICONTROL Advanced selection]** to select the filtering mode.\n\n   ![](assets/s_ncs_user_create_exp_exple_a.png)\n\n1. Select **[!UICONTROL Edit the formula using an expression]** and click **[!UICONTROL Next]** to display the expression editor.\n1. In the list of functions, double-click **[!UICONTROL Day]**, which is accessible via the **[!UICONTROL Date]** node. This function returns the number representing the day corresponding to the date passed as a parameter.\n\n   ![](assets/s_ncs_user_create_exp_exple01.png)\n\n1. In the list of available fields, double-click **[!UICONTROL Birth date]**. The upper section of the editor then displays the following formula:\n\n   ```\n   Day(@birthDate)\n   ```\n\n   Click **[!UICONTROL Finish]** to confirm.\n\n1. In the query editor, in the first cell of the **[!UICONTROL Operator]** column, select **[!UICONTROL equal to]**.\n\n   ![](assets/s_ncs_user_create_exp_exple02.png)\n\n1. Next, click the first cell of the second column (**[!UICONTROL Value]**), and click **[!UICONTROL Edit expression]** to open the expression editor.\n1. In the list of functions, double-click **[!UICONTROL Day]**, which is accessible via the **[!UICONTROL Date]** node.\n1. Double-click the **[!UICONTROL GetDate]** function to retrieve the current date.\n\n   ![](assets/s_ncs_user_create_exp_exple04.png)\n\n   The upper section of the editor displays the following formula:\n\n   ```\n   Day(GetDate())\n   ```\n\n   Click **[!UICONTROL Finish]** to confirm.\n\n1. Repeat this procedure to retrieve the month of birth corresponding to the current month. To do this, click the **[!UICONTROL Add]** button and repeat steps 3 to 10, replacing **[!UICONTROL Day]** with **[!UICONTROL Month]**.\n\n   The complete query is as follows:\n\n   ![](assets/s_ncs_user_create_exp_exple03.png)\n\nLink the result of the **[!UICONTROL Query]** activity to an **[!UICONTROL Email delivery]** activity to send an email to the list of all of your recipients on their birthday.\n\n## Including recipients born on February 29th (optional) {#including-recipients-born-on-february-29th--optional-}\n\nIf you want to include all recipients who were born on February 29th, this use case presents how to plan sending a recurring email to a list of recipients for their birthday - whether it is a leap year or not.\n\nThe main implementation steps for this use case are:\n\n* Selecting recipients\n* Selecting whether or not it is a leap year\n* Selecting any recipients born on February 29th\n\nTo set up this use case, we created the following targeting workflow:\n\n\n\nIf the current year **is not a leap year** and the workflow is run on March 1st, we need to select all recipients that would have had their birthday yesterday (February 29th) and add them to the recipients list. In any other case no additional action is required.\n\n### Step 1: Selecting the recipients {#step-1--selecting-the-recipients}\n\nAfter configuring the **[!UICONTROL Scheduler]** activity so that the workflow starts every day, identify all of the recipients whose anniversary is the current day.\n\n>[!NOTE]\n>\n>If the current year is a leap year, all of the recipients born on the 29th of February are automatically included.\n\n![](assets/birthday-workflow_usecase_2.png)\n\nSelecting recipients whose birthday corresponds to the current date is presented in the [Identifying recipients whose birthday it is](#identifying-recipients-whose-birthday-it-is) section.\n\n### Step 2: Select whether or not it is a leap year {#step-2--select-whether-or-not-it-is-a-leap-year}\n\nThe **[!UICONTROL Test]** activity allows you to check whether or not it is a leap year and whether the current date is March 1st.\n\nIf the test is verified (the year is not a leap year - there is no February 29th - and the current date is indeed March 1st), the **[!UICONTROL True]** transition is enabled and the recipients born on February 29th will be added to the March 1st delivery. Otherwise, the **[!UICONTROL False]** transition is enabled and only the recipients born on the current date will receive the delivery.\n\nCopy and paste the code below into the **[!UICONTROL Initialization script]** section of the **[!UICONTROL Advanced]** tab.\n\n```\nfunction isLeapYear(iYear)\n{\n    if(iYear/4 == Math.floor(iYear/4))\n    {\n        if(iYear/100 != Math.floor(iYear/100))\n        {\n            // Divisible by 4 only -> Leap Year\n            return 1;\n        }\n        else\n        {\n            if(iYear/400 == Math.floor(iYear/400))\n            {\n                // Divisible by 4, 100 and 400 -> Leap year\n                return 1;\n            }\n        }\n    }\n    // all others: no leap year\n    return 0;\n}\n\n// Return today's date and time\nvar currentTime = new Date()\n// returns the month (from 0 to 11)\nvar month = currentTime.getMonth() + 1\n// returns the day of the month (from 1 to 31)\nvar day = currentTime.getDate()\n// returns the year (four digits)\nvar year = currentTime.getFullYear()\n\n// is current year a leap year?\nvars.currentIsALeapYear = isLeapYear(year);\n\n// is current date the first of march?\nif(month == 3 && day == 1) {\n  // today is 1st of march\nvars.firstOfMarch = 1;\n}\n```\n\n![](assets/birthday-workflow_usecase_3.png)\n\nAdd the following condition in the **[!UICONTROL Conditional forks]** section:\n\n```\nvars.currentIsALeapYear == 0 && vars.firstOfMarch == 1\n```\n\n![](assets/birthday-workflow_usecase_4.png)\n\n### Step 3: Select any recipients born on February 29th {#step-3--select-any-recipients-born-on-february-29th}\n\nCreate a **[!UICONTROL Fork]** activity and link one of the outbound transitions to a **[!UICONTROL Query]** activity.\n\nIn this query, select all of the recipients whose date of birth is February 29th.\n\n![](assets/birthday-workflow_usecase_5.png)\n\nCombine the results with a **[!UICONTROL Union]** activity.\n\nLink the results of the two **[!UICONTROL Test]** activity branches to an **[!UICONTROL Email delivery]** activity to send an email to the list of all of your recipients on their birthday, even to those born on February 29th during a non-leap year.\n\n## Creating a recurring delivery {#creating-a-recurring-delivery-in-a-targeting-workflow}\n\nAdd a **Recurring delivery** activity based on the birthday email template that you want to send.\n\n>[!CAUTION]\n>\n>For the workflows to execute, the technical workflows relating to the Campaign package must be started. For more on this, refer to the [List of technical workflows](about-technical-workflows.md) section.\n>\n>If the approval steps are enabled for the campaign, the deliveries will only be sent once these steps have been confirmed. For more on this, refer to the [Choosing the processes to be approved](../../campaign/using/marketing-campaign-approval.md#choosing-the-processes-to-be-approved) section.\n\n![](assets/birthday-workflow_usecase_1.png)\n","headers":[["title","Send a birthday email"],["description","Learn how to send a birthday email with a workflow"],["feature","Workflows"]],"sections":[{"section":"Send a birthday email","sectionId":"6b089ad6-2786-4430-b9e7-34aa81c217dd","paragraphs":[]},{"section":"Introduction","sectionId":"988d9599-73ff-4a95-b173-2f0e46558c37","paragraphs":["This use case presents how to plan sending a recurring email to a list of recipients on the day of their birthday.","To set up this use case, we created the following targeting workflow:","This (daily run) workflow selects all recipients that have their birthday on the current date.","This use case can also be found in the form of a video. For more on this, refer to the Creating a workflow video.","To do this, create a campaign and click the Targeting and workflows tab. For more on this, refer to the Building the main target in a workflow section.","Then follow these steps:"]},{"section":"Scheduling the sending","sectionId":"4cc97702-1a12-4681-820d-11846cf0d734","paragraphs":["First, add a Scheduler to trigger sending the delivery every day. In the example below, the delivery is created every day at 6am."]},{"section":"Identifying recipients whose birthday it is","sectionId":"283b2faf-628e-4fa5-b2a9-d670c7cf6023","paragraphs":["After configuring the Scheduler activity so that the workflow starts every day, identify all of the recipients whose date of birth equals the current date.","To do this, apply the following steps:","Drag and drop a Query activity into the workflow and double-click it.","Click the Edit query link and select Filtering conditions.","Click the first cell of the Expression column and click Edit expression to open the expression editor.","Click Advanced selection to select the filtering mode.","Select Edit the formula using an expression and click Next to display the expression editor.","In the list of functions, double-click Day, which is accessible via the Date node. This function returns the number representing the day corresponding to the date passed as a parameter.","In the list of available fields, double-click Birth date. The upper section of the editor then displays the following formula:","Day(@birthDate)","Click Finish to confirm.","In the query editor, in the first cell of the Operator column, select equal to.","Next, click the first cell of the second column (Value), and click Edit expression to open the expression editor.","In the list of functions, double-click Day, which is accessible via the Date node.","Double-click the GetDate function to retrieve the current date.","The upper section of the editor displays the following formula:","Day(GetDate())","Click Finish to confirm.","Repeat this procedure to retrieve the month of birth corresponding to the current month. To do this, click the Add button and repeat steps 3 to 10, replacing Day with Month.","The complete query is as follows:","Link the result of the Query activity to an Email delivery activity to send an email to the list of all of your recipients on their birthday."]},{"section":"Including recipients born on February 29th (optional)","sectionId":"45723912-6ad8-4651-a846-5fe0b2e8a0ad","paragraphs":["If you want to include all recipients who were born on February 29th, this use case presents how to plan sending a recurring email to a list of recipients for their birthday - whether it is a leap year or not.","The main implementation steps for this use case are:","Selecting recipients\nSelecting whether or not it is a leap year\nSelecting any recipients born on February 29th","To set up this use case, we created the following targeting workflow:","If the current year is not a leap year and the workflow is run on March 1st, we need to select all recipients that would have had their birthday yesterday (February 29th) and add them to the recipients list. In any other case no additional action is required."]},{"section":"Step 1: Selecting the recipients","sectionId":"66c9536d-fae5-45dc-9584-bfbed7cf1669","paragraphs":["After configuring the Scheduler activity so that the workflow starts every day, identify all of the recipients whose anniversary is the current day.","NOTE","If the current year is a leap year, all of the recipients born on the 29th of February are automatically included.","Selecting recipients whose birthday corresponds to the current date is presented in the Identifying recipients whose birthday it is section."]},{"section":"Step 2: Select whether or not it is a leap year","sectionId":"d7fd3c2e-3ddb-4a81-aa64-32ce49ed025e","paragraphs":["The Test activity allows you to check whether or not it is a leap year and whether the current date is March 1st.","If the test is verified (the year is not a leap year - there is no February 29th - and the current date is indeed March 1st), the True transition is enabled and the recipients born on February 29th will be added to the March 1st delivery. Otherwise, the False transition is enabled and only the recipients born on the current date will receive the delivery.","Copy and paste the code below into the Initialization script section of the Advanced tab.","function isLeapYear(iYear)\n{\n    if(iYear/4 == Math.floor(iYear/4))\n    {\n        if(iYear/100 != Math.floor(iYear/100))\n        {\n            // Divisible by 4 only -> Leap Year\n            return 1;\n        }\n        else\n        {\n            if(iYear/400 == Math.floor(iYear/400))\n            {\n                // Divisible by 4, 100 and 400 -> Leap year\n                return 1;\n            }\n        }\n    }\n    // all others: no leap year\n    return 0;\n}","// Return today's date and time\nvar currentTime = new Date()\n// returns the month (from 0 to 11)\nvar month = currentTime.getMonth() + 1\n// returns the day of the month (from 1 to 31)\nvar day = currentTime.getDate()\n// returns the year (four digits)\nvar year = currentTime.getFullYear()","// is current year a leap year?\nvars.currentIsALeapYear = isLeapYear(year);","// is current date the first of march?\nif(month == 3 && day == 1) {\n  // today is 1st of march\nvars.firstOfMarch = 1;\n}","Add the following condition in the Conditional forks section:","vars.currentIsALeapYear == 0 && vars.firstOfMarch == 1"]},{"section":"Step 3: Select any recipients born on February 29th","sectionId":"caa88665-7380-4410-acba-0591fb7825b2","paragraphs":["Create a Fork activity and link one of the outbound transitions to a Query activity.","In this query, select all of the recipients whose date of birth is February 29th.","Combine the results with a Union activity.","Link the results of the two Test activity branches to an Email delivery activity to send an email to the list of all of your recipients on their birthday, even to those born on February 29th during a non-leap year."]},{"section":"Creating a recurring delivery","sectionId":"10ec928a-4c3a-49e8-ad64-02e83533db11","paragraphs":["Add a Recurring delivery activity based on the birthday email template that you want to send.","CAUTION","For the workflows to execute, the technical workflows relating to the Campaign package must be started. For more on this, refer to the List of technical workflows section.","If the approval steps are enabled for the campaign, the deliveries will only be sent once these steps have been confirmed. For more on this, refer to the Choosing the processes to be approved section."]}]}