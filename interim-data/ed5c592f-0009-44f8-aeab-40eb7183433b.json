{"guid":"ed5c592f-0009-44f8-aeab-40eb7183433b","title":"Configure access to Teradata","path":"help\\installation\\using\\configure-fda-teradata.md","fullText":"---\nproduct: campaign\ntitle: Configure access to Teradata\ndescription: Learn how to configure access to Teradata in FDA\nfeature: Installation, Federated Data Access\naudience: platform\ncontent-type: reference\ntopic-tags: connectors\nexl-id: 3a5856c3-b642-4722-97ff-6ae7107efdbe\n---\n# Configure access to Teradata {#configure-access-to-teradata}\n\n\n\nUse Campaign [Federated Data Access](../../installation/using/about-fda.md) (FDA) option to process information stored in an external databases. Follow the steps below to configure access to Teradata.\n\n1. Install and configure [Teradata drivers](#teradata-config)\n1. Configure the Teradata [external account](#teradata-external) in Campaign\n1. Set up [additional configuration](#teradata-additional-configurations) for Teradata and Campaign server\n\n## Teradata configuration {#teradata-config}\n\nYou need to install drivers for Teradata to have connection to Campaign implemented.\n\n1. Install the [ODBC driver for Teradata](https://downloads.teradata.com/download/connectivity/odbc-driver/linux).\n\n   It is made up of three packages that can be installed on Red Hat (or CentOS)/Suse in the following order:\n\n    * TeraGSS\n    * tdicu1510 (install it using setup_wrapper.sh)\n    * tdodbc1510 (install it using setup_wrapper.sh)\n\n1. Configure the ODBC driver. The configuration can be carried out in the standard files: **/etc/odbc.ini** for general parameters and /etc/odbcinst.ini for declaring drivers:\n\n    * **/etc/odbc.ini**\n\n      ```\n      [ODBC]\n      InstallDir=/etc/\n      ```\n\n      \"InstallDir\" corresponds to the location of the **odbcinst.ini** file.\n\n    * **/etc/odbcinst.ini**\n\n      ```\n      [ODBC DRIVERS]\n      teradata=Installed\n\n      [teradata]\n      Driver=/opt/teradata/client/17.10/lib64/tdataodbc_sb64.so\n      APILevel=CORE\n      ConnectFunctions=YYY\n      DriverODBCVer=3.51\n      SQLLevel=1\n      ```\n\n1. Specify the environment variables of the Adobe Campaign server:\n\n    * **LD_LIBRARY_PATH**: /opt/teradata/client/15.10/lib64 and /opt/teradata/client/15.10/odbc_64/lib.\n    * **ODBCINI**: location of the odbc.ini file (for example /etc/odbc.ini).\n    * **NLSPATH**: location of the opermsgs.cat file (/opt/teradata/client/15.10/msg/opermsgs.cat)\n\n>[!NOTE]\n>\n>Connecting to a Teradata external database in FDA requires additional configurations steps on the Adobe Campaign server. [Learn more](#teradata-additional-configurations).\n>\n\n## Teradata external account{#teradata-external}\n\nThe Teradata external account allows you to connect your Campaign instance to your Teradata external database. \n\n1. From Campaign **[!UICONTROL Explorer]**, click **[!UICONTROL Administration]** / **[!UICONTROL Platform]** / **[!UICONTROL External accounts]**.\n\n1. Click **[!UICONTROL New]** and select **[!UICONTROL External database]** as **[!UICONTROL Type]**.\n\n    ![](assets/ext_account_19.png)\n\n1. To configure the **[!UICONTROL Teradata]** external account, you must specify:\n\n    * **[!UICONTROL Type]**: Choose the **[!UICONTROL Teradata]** type.\n\n    * **[!UICONTROL Server]**: URL or name of your Teradata server\n\n    * **[!UICONTROL Account]**: Name of the account used to access the Teradata database\n\n    * **[!UICONTROL Password]**: Password used to connect to the Teradata database\n\n    * **[!UICONTROL Database]**: Name of the database (optional)\n\n    * **[!UICONTROL Options]**: Options to be passed through Teradata. Use the following format: 'parameter=value'. Use a semicolon as separator between values.\n\n    * **[!UICONTROL Timezone]**: Timezone set in Teradata. [Learn more](#timezone)\n\nThe connector supports the following options:\n\n| Option   |  Description |\n|---|---|\n| TD_MAX_SESSIONS | Specifies the maximum number of logon sessions that the Teradata Parallel Transporter can acquire for an operator job. |\n| TimeZoneName | Name of the server time zone. |\n| CharacterSet | Used to configure Teradata character set. <br>For more on this, refer to [this page](https://docs.teradata.com/r/ODBC-Driver-for-Teradata-User-Guide/May-2017/Configuration-of-odbc.ini-in-UNIX/Linux-and-Apple-OS-X/Teradata-DSN-Options#rub1478609534082__table_N102D3_N102B6_N102B3_N10001).|\n| IANAAppCodePage | ODBC application code page. <br>For more on this, refer to [this page](https://docs.teradata.com/r/ODBC-Driver-for-Teradata-User-Guide/May-2017/ODBC-Driver-for-Teradata-Application-Development/International-Character-Set-Support/Application-Code-Page)|\n\n### Add additional ODBC external accounts {#add-external}\n\n>[!NOTE]\n>\n> This option is not available for builds older than the 7.3.1 version.\n\nThe Teradata driver provides its own ODBC library but this library may not be compatible with other ODBC external accounts. \n\nIf you want to configure another external account that also uses ODBC, e.g. Snowflake, you will need to add an ODBCLib option set to the path of the default ODBC library (`/usr/lib/x86_64-linux-gnu/libodbc.so` on Debian and `/usr/lib64/libodbc.so` on RHEL/CentOS).\n\n![](assets/ext_account_24.png)\n\n### Query banding\n\nWhen multiple Adobe Campaign users connect to the same FDA Teradata external account, the **[!UICONTROL Query banding]** tab allows you to set a query band, i.e. a set of key/value pairs, on a session.\n\n![](assets/ext_account_20.png)\n\nWhen this option is configured, each time a Campaign user performs a query on the Teradata database, Adobe Campaign will send meta data, which consists of a list of keys, associated to this user. This data can then be used by Teradata administrators for audit purposes or to manage access rights.\n\n>[!NOTE]\n>\n>For more information on **[!UICONTROL Query banding]**, refer to the [Teradata documentation](https://docs.teradata.com/reader/cY5B~oeEUFWjgN2kBnH3Vw/a5G1iz~ve68yTMa24kVjVw).\n\nTo configure Query banding, follow the steps below:\n\n1. Use the  **[!UICONTROL Default]** to enter a default query band that will be used if a user has no associated query band. If this field is left empty, the users with no query band will not be able to use Teradata.\n\n1. Use the **[!UICONTROL Users]** field to specify a query band for each user. You can add as many key/value pairs as you need e.g. priority=1;workload=high. If the user has no query band assigned, the **[!UICONTROL Default]** field will be applied.\n\n1. Check the **[!UICONTROL Active]** box to activate this feature\n\n#### External account troubleshooting {#external-account-troubleshooting}\n\nIf the following error appears while testing the connection **TIM-030008 Date '2': missing character(s) (iRc=-53)** make sure that the ODBC driver is correctly installed and that the LD_LIBRARY_PATH (Linux) / PATH (Windows) is set for the Campaign server.\n\nThe error **ODB-240000 ODBC error: [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified.** occurs with Windows if you use a 16.X driver. Adobe Campaign expects the teradata to be named '{teradata}' in odbcinst.ini.\n\n* Starting Campaign 18.10, you can add ODBCDriverName=\"Teradata Database ODBC Driver 16.10\" in the options of the external account. The version number can change, the exact name can be found by running odbcad32.exe and accessing to the Drivers tab.\n\n* If you are using an older Campaign version, you will have to copy the Teradata section of odbcinst.ini created by the driver installation to a new section called Teradata. Regedit can be used in this case. If your base is in latin1, you will have to add **APICharSize=1** in the options.\n\n## Additional configurations {#teradata-additional-configurations}\n\n<!--\n### Compatibility {#teradata-compatibility}\n\n**Based in Unicode**\n\n| Database version | Driver version |  Minimal Campaign version required |  Note |\n|:-:|:-:|:-:|:-:|\n| 15  |  15 |  Campaign Classic 17.9 | Under Linux: Queries with timestamp may fail (fixed in build 8937 for 18.4 and 8977 for 18.10) In debug mode, warnings relative to bad memory usage in the driver may occur. |\n| 15  | 16  | Campaign Classic 17.9  | Recommended setup for a Teradata 15 database under Linux.  |\n|  16 | 16  | Campaign Classic 18.10 |  Unicode characters with surrogate pairs are not fully handled. Using surrogate characters in data should work. Using surrogates in a filtering condition of a query will not work without this change. |\n| 16  |  15 |  Campaign Classic 19.0 |  &nbsp; |\n\n**Based in Latin1**\n\nVersions previous to Adobe Campaign Classic 17.9 only supported Teradata Latin-1 database.\n\nStarting from Adobe Campaign Classic 17.9, we now support by default Teradata database in Unicode.\n\nCustomers with a Latin-1 Teradata database migrating to a recent Campaign Classic release will have to add the parameter APICharSize=1 in the options of the external account.\n-->\n\n### User configuration {#user-configuration}\n\nThe following rights are required on the external database: create/drop/execute custom procedures, create/drop/insert/select tables. You may also have to create user mode functions if you want to use md5 and sha2 function on your Adobe Campaign instance.\n\nMake sure to configure the correct time zone. It should match what will be set in the external account created in the Adobe Campaign instance.\n\nAdobe Campaign will not set a protection mode (fallback) on the objects it will create in the database. You might need to set a default on the user that Adobe Campaign will use to connect to the Teradata database using the following query:\n\n| disable default fallback  |\n| :-: |\n| ```MODIFY USER $login$ AS NO FALLBACK;```  |\n\n### MD5 installation {#md5-installation}\n\nIf you want to use md5 functions in your Adobe Campaign instance, you will have to install the user mode function on your Teradata database from this [page](https://downloads.teradata.com/download/extensibility/md5-message-digest-udf) (md5_20080530.zip).\n\nThe sha1 of the downloaded file is as follows 65cc0bb6935f72fcd84fef1ebcd64c00115dfd1e.\n\nTo install md5:\n\n1. Unzip the md5_20080530.zip file.\n\n1. Go to the md5/src directory.\n\n1. Connect to your Teradata database using bteq.\n\n1. Run the following bteq command:\n\n    ```\n    .run file = hash_md5.btq\n    ```\n\n### SHA2 installation {#sha2-installation}\n\nIf you want to use sha2 functions in your Adobe Campaign instance, you will have to install the user mode function on your Teradata database from this [page](https://github.com/akuroda/teradata-udf-sha2/archive/v1.0.zip) (teradata-udf-sha2-1.0.zip).\n\nThe sha1 of the downloaded file is as follows e87438d37424836358bd3902cf1adeb629349780.\n\nTo install sha2:\n\n1. Unzip the teradata-udf-sha2-1.0.zip file.\n\n1. Go to the teradata-udf-sha2-1.0/src directory.\n\n1. Connect to your Teradata database using bteq.\n\n1. Run the two following bteq commands:\n\n    ```\n    .run file = hash_sha256.sql\n    .run file = hash_sha512.sql\n    ```\n\n### UDF_UTF16TO8 installation {#UDF-UTF16TO8-installation}\n\nIf you want to use udf_utf16to8 functions in your Adobe Campaign instance, install the user mode function on your Teradata database from the **Teradata unicode tool kit**.\n\nThe sha1 of the downloaded file is as follows e58235f434f52c71316a577cb48e20b97d24f470.\n\nTo install udf_utf16to8:\n\n1. Unzip the utk_release1.7.0.0.zip file.\n\n1. Look for the udf_utf16to8.o in the extracted files and navigate to the directory that contains the file. It should be named utk_release1.7.0.0/utk_release1.7.0.0/04 TranslationUDFs/01 Teradata UDFs/suselinux-x8664/udf_installation/.\n\n1. Connect to your Teradata database using bteq.\n\n1. Type in the following bteq command:\n\n    ```\n    REPLACE FUNCTION udf_utf16to8 (\n    inputString VARCHAR(8000) CHARACTER SET UNICODE\n    ) RETURNS VARCHAR(16000) CHARACTER SET LATIN\n    LANGUAGE C\n    NO SQL\n    EXTERNAL NAME 'CO!i18n103!udf_utf16to8.o!F!udf_utf16to8'\n    PARAMETER STYLE SQL;\n  \n    -- Test: should return 410042\n    SELECT CAST(Char2HexInt(UDF_UTF16to8(_UNICODE'004100000042'XC)) AS VARCHAR(100));\n    ```\n\n## Campaign server configuration for Linux {#campaign-server-linux}\n\nThe following is required for the driver installation:\n\n* Teradata ODBC Driver, which can be found in this [page](https://downloads.teradata.com/download/connectivity/odbc-driver/linux)\n\n* Teradata Tools and Utilities (used for the bulk load), which can be found in this [page](https://downloads.teradata.com/download/tools/teradata-tools-and-utilities-linux-installation-package-0)\n\nFile names and sha1:\n\n* tdodbc1620__linux_indep.16.20.00.00-1.tar.gz 121fdd978b56fe1304fc5cb7819741b0847f44fd\n\n* TeradataToolsAndUtilitiesBase__linux_indep.16.20.01.00.tar.gz b 29d0af5ffd8dcf68a9dbbaa6f8639387b19c563\n\nIf there is no package for your Linux distribution, you can install as explained on a CentOS 7 (for example using docker) and then copy the content of the /opt/teradata on your Adobe Campaign server.\n\n### ODBC driver installation {#odbc-installation}\n\nTo install ODBC driver:\n\n1. Extract the tdodbc1620__linux_indep.16.20.00.00-1.tar.gz file.\n\n1. Go to the tdodbc1620 directory.\n\n1. You might need to fix the setup script:\n\n    ```\n    \"sed -i s/16.10/16.20/ setup_wrapper.sh\".\n    ```\n\n1. Run the setup_wrapper.sh.\n\n### Teradata tools and utilities installation {#teradata-tools-installation}\n\nTo install Tools:\n\n1. Extract the TeradataToolsAndUtilitiesBase__linux_indep.16.20.01.00.tar.gz file.\n\n1. Go to the TeradataToolsAndUtilitiesBase/Linux/i386-x8664/tdicu directory.\n\n1. Run the setup_wrapper.sh.\n\n1. Go to the TeradataToolsAndUtilitiesBase/Linux/i386-x8664/cliv2 directory.\n\n1. Run the setup_wrapper.sh.\n\n1. Go to the TeradataToolsAndUtilitiesBase/Linux/i386-x8664/tptbase directory.\n\n1. Run the setup_wrapper.sh.\n\n1. A libtelapi.so file should be available in /opt/teradata/client/16.20/lib64.\n\n## Campaign server configuration for Windows {#campaign-server-windows}\n\nYou first need to download Teradata Tools and utilities for Windows. You can download it from this [page](https://downloads.teradata.com/download/tools/teradata-tools-and-utilities-windows-installation-package)\n\nMake sure to install the ODBC driver and the Teradata Parallel Transporter Base. It will install telapi.dll used to do bulk load on Teradata database.\n\nMake sure the path of the driver and the utilities is in the PATH variable that nlserver will have during execution. By default the path is C:\\Program Files (x86)\\Teradata\\Client\\15.10\\bin on Windows 32 bits or C:\\Program Files\\Teradata\\Client\\15.10\\bin on 64 bit).\n\n## Time zone {#timezone}\n\nTeradata uses time zone name that are not standard, you can find the list on the [Teradata site](https://docs.teradata.com/reader/rgAb27O_xRmMVc_aQq2VGw/oGKvgl7gCeBMTGrp59BnwA). Adobe Campaign will try to convert the time zone given in the external configuration to something Teradata understand. If a correspondence is not found, the closet GMT+X (or GMT-X) time zone will be found for the session, with a warning in the log.\n\nThe conversion is done reading a file called teradata_timezones.txt that should be in the following datakit directory: /usr/local/neolane/nl6/datakit under linux. If you edit this file, make sure to contact the Adobe Campaign team to make the change in the source code otherwise this file will be overwritten during next Campaign update.\n\nThe time zone used to connect will be indicated when running nlserver with the -verbose switch, for example:\n\n```\n15:04:04 >   ODB-240007 Teradata: will use 'Europe Central' as session time zone.\n```\n\nIf the time zone used is not the correct one, an option named \"TimeZoneName\" can be added on the external account. In that case, use the Teradata Value, for example \"TimeZoneName=Europe Central\".\n\nWhen using bulk load, or \"fast load\" in Teradata documents, Campaign can't indicate the time zone. Therefore, it is recommended to set the default time zone of the user that Campaign will use to connect:\n\n```\nMODIFY USER $login$ AS TIME ZONE = 'Europe Central';\n```\n","headers":[["title","Configure access to Teradata"],["description","Learn how to configure access to Teradata in FDA"],["feature","Installation, Federated Data Access"],["topic-tags","connectors"]],"sections":[{"section":"Configure access to Teradata","sectionId":"a69547af-4b91-42b6-a875-ef44edc77f4a","paragraphs":["Use Campaign Federated Data Access (FDA) option to process information stored in an external databases. Follow the steps below to configure access to Teradata.","Install and configure Teradata drivers\nConfigure the Teradata external account in Campaign\nSet up additional configuration for Teradata and Campaign server"]},{"section":"Teradata configuration","sectionId":"1951ad61-8cd5-4509-a10a-675d6150e146","paragraphs":["You need to install drivers for Teradata to have connection to Campaign implemented.","Install the ODBC driver for Teradata.","It is made up of three packages that can be installed on Red Hat (or CentOS)/Suse in the following order:","TeraGSS\ntdicu1510 (install it using setup_wrapper.sh)\ntdodbc1510 (install it using setup_wrapper.sh)","Configure the ODBC driver. The configuration can be carried out in the standard files: /etc/odbc.ini for general parameters and /etc/odbcinst.ini for declaring drivers:","/etc/odbc.ini","[ODBC]\nInstallDir=/etc/","\"InstallDir\" corresponds to the location of the odbcinst.ini file.","/etc/odbcinst.ini","[ODBC DRIVERS]\nteradata=Installed","[teradata]\nDriver=/opt/teradata/client/17.10/lib64/tdataodbc_sb64.so\nAPILevel=CORE\nConnectFunctions=YYY\nDriverODBCVer=3.51\nSQLLevel=1","Specify the environment variables of the Adobe Campaign server:","LD_LIBRARY_PATH: /opt/teradata/client/15.10/lib64 and /opt/teradata/client/15.10/odbc_64/lib.\nODBCINI: location of the odbc.ini file (for example /etc/odbc.ini).\nNLSPATH: location of the opermsgs.cat file (/opt/teradata/client/15.10/msg/opermsgs.cat)","NOTE","Connecting to a Teradata external database in FDA requires additional configurations steps on the Adobe Campaign server. Learn more."]},{"section":"Teradata external account","sectionId":"17abf9ef-8259-4c38-8f2c-4a8d1409f6f8","paragraphs":["The Teradata external account allows you to connect your Campaign instance to your Teradata external database.","From Campaign Explorer, click Administration / Platform / External accounts.","Click New and select External database as Type.","","To configure the Teradata external account, you must specify:","Type: Choose the Teradata type.","Server: URL or name of your Teradata server","Account: Name of the account used to access the Teradata database","Password: Password used to connect to the Teradata database","Database: Name of the database (optional)","Options: Options to be passed through Teradata. Use the following format: 'parameter=value'. Use a semicolon as separator between values.","Timezone: Timezone set in Teradata. Learn more","The connector supports the following options:","Option Description\nTD_MAX_SESSIONS Specifies the maximum number of logon sessions that the Teradata Parallel Transporter can acquire for an operator job.\nTimeZoneName Name of the server time zone.\nCharacterSet Used to configure Teradata character set. For more on this, refer to this page.\nIANAAppCodePage ODBC application code page. For more on this, refer to this page"]},{"section":"Add additional ODBC external accounts","sectionId":"0e2b59c9-9bd7-4a65-b3d4-f2f9c6b922f1","paragraphs":["NOTE","This option is not available for builds older than the 7.3.1 version.","The Teradata driver provides its own ODBC library but this library may not be compatible with other ODBC external accounts.","If you want to configure another external account that also uses ODBC, e.g. Snowflake, you will need to add an ODBCLib option set to the path of the default ODBC library (/usr/lib/x86_64-linux-gnu/libodbc.so on Debian and /usr/lib64/libodbc.so on RHEL/CentOS)."]},{"section":"Query banding","sectionId":"acbecc80-2166-47fb-a528-b914325aa87f","paragraphs":["When multiple Adobe Campaign users connect to the same FDA Teradata external account, the Query banding tab allows you to set a query band, i.e. a set of key/value pairs, on a session.","When this option is configured, each time a Campaign user performs a query on the Teradata database, Adobe Campaign will send meta data, which consists of a list of keys, associated to this user. This data can then be used by Teradata administrators for audit purposes or to manage access rights.","NOTE","For more information on Query banding, refer to the Teradata documentation.","To configure Query banding, follow the steps below:","Use the  Default to enter a default query band that will be used if a user has no associated query band. If this field is left empty, the users with no query band will not be able to use Teradata.","Use the Users field to specify a query band for each user. You can add as many key/value pairs as you need e.g. priority=1;workload=high. If the user has no query band assigned, the Default field will be applied.","Check the Active box to activate this feature"]},{"section":"External account troubleshooting","sectionId":"eeda364b-19f7-4b3e-bbb0-c836d11dccb0","paragraphs":["If the following error appears while testing the connection TIM-030008 Date '2': missing character(s) (iRc=-53) make sure that the ODBC driver is correctly installed and that the LD_LIBRARY_PATH (Linux) / PATH (Windows) is set for the Campaign server.","The error ODB-240000 ODBC error: [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified. occurs with Windows if you use a 16.X driver. Adobe Campaign expects the teradata to be named '' in odbcinst.ini.","Starting Campaign 18.10, you can add ODBCDriverName=\"Teradata Database ODBC Driver 16.10\" in the options of the external account. The version number can change, the exact name can be found by running odbcad32.exe and accessing to the Drivers tab.","If you are using an older Campaign version, you will have to copy the Teradata section of odbcinst.ini created by the driver installation to a new section called Teradata. Regedit can be used in this case. If your base is in latin1, you will have to add APICharSize=1 in the options."]},{"section":"Additional configurations","sectionId":"963f0fe1-63a0-4394-be69-d43c091833a6","paragraphs":["User configuration","The following rights are required on the external database: create/drop/execute custom procedures, create/drop/insert/select tables. You may also have to create user mode functions if you want to use md5 and sha2 function on your Adobe Campaign instance.","Make sure to configure the correct time zone. It should match what will be set in the external account created in the Adobe Campaign instance.","Adobe Campaign will not set a protection mode (fallback) on the objects it will create in the database. You might need to set a default on the user that Adobe Campaign will use to connect to the Teradata database using the following query:","disable default fallback\nMODIFY USER $login$ AS NO FALLBACK;","MD5 installation","If you want to use md5 functions in your Adobe Campaign instance, you will have to install the user mode function on your Teradata database from this page (md5_20080530.zip).","The sha1 of the downloaded file is as follows 65cc0bb6935f72fcd84fef1ebcd64c00115dfd1e.","To install md5:","Unzip the md5_20080530.zip file.","Go to the md5/src directory.","Connect to your Teradata database using bteq.","Run the following bteq command:",".run file = hash_md5.btq","SHA2 installation","If you want to use sha2 functions in your Adobe Campaign instance, you will have to install the user mode function on your Teradata database from this page (teradata-udf-sha2-1.0.zip).","The sha1 of the downloaded file is as follows e87438d37424836358bd3902cf1adeb629349780.","To install sha2:","Unzip the teradata-udf-sha2-1.0.zip file.","Go to the teradata-udf-sha2-1.0/src directory.","Connect to your Teradata database using bteq.","Run the two following bteq commands:",".run file = hash_sha256.sql\n.run file = hash_sha512.sql","UDF_UTF16TO8 installation","If you want to use udf_utf16to8 functions in your Adobe Campaign instance, install the user mode function on your Teradata database from the Teradata unicode tool kit.","The sha1 of the downloaded file is as follows e58235f434f52c71316a577cb48e20b97d24f470.","To install udf_utf16to8:","Unzip the utk_release1.7.0.0.zip file.","Look for the udf_utf16to8.o in the extracted files and navigate to the directory that contains the file. It should be named utk_release1.7.0.0/utk_release1.7.0.0/04 TranslationUDFs/01 Teradata UDFs/suselinux-x8664/udf_installation/.","Connect to your Teradata database using bteq.","Type in the following bteq command:","REPLACE FUNCTION udf_utf16to8 (\ninputString VARCHAR(8000) CHARACTER SET UNICODE\n) RETURNS VARCHAR(16000) CHARACTER SET LATIN\nLANGUAGE C\nNO SQL\nEXTERNAL NAME 'CO!i18n103!udf_utf16to8.o!F!udf_utf16to8'\nPARAMETER STYLE SQL;","-- Test: should return 410042\nSELECT CAST(Char2HexInt(UDF_UTF16to8(_UNICODE'004100000042'XC)) AS VARCHAR(100));","Campaign server configuration for Linux","The following is required for the driver installation:","Teradata ODBC Driver, which can be found in this page","Teradata Tools and Utilities (used for the bulk load), which can be found in this page","File names and sha1:","tdodbc1620__linux_indep.16.20.00.00-1.tar.gz 121fdd978b56fe1304fc5cb7819741b0847f44fd","TeradataToolsAndUtilitiesBase__linux_indep.16.20.01.00.tar.gz b 29d0af5ffd8dcf68a9dbbaa6f8639387b19c563","If there is no package for your Linux distribution, you can install as explained on a CentOS 7 (for example using docker) and then copy the content of the /opt/teradata on your Adobe Campaign server.","ODBC driver installation","To install ODBC driver:","Extract the tdodbc1620__linux_indep.16.20.00.00-1.tar.gz file.","Go to the tdodbc1620 directory.","You might need to fix the setup script:","\"sed -i s/16.10/16.20/ setup_wrapper.sh\".","Run the setup_wrapper.sh.","Teradata tools and utilities installation","To install Tools:","Extract the TeradataToolsAndUtilitiesBase__linux_indep.16.20.01.00.tar.gz file.","Go to the TeradataToolsAndUtilitiesBase/Linux/i386-x8664/tdicu directory.","Run the setup_wrapper.sh.","Go to the TeradataToolsAndUtilitiesBase/Linux/i386-x8664/cliv2 directory.","Run the setup_wrapper.sh.","Go to the TeradataToolsAndUtilitiesBase/Linux/i386-x8664/tptbase directory.","Run the setup_wrapper.sh.","A libtelapi.so file should be available in /opt/teradata/client/16.20/lib64.","Campaign server configuration for Windows","You first need to download Teradata Tools and utilities for Windows. You can download it from this page","Make sure to install the ODBC driver and the Teradata Parallel Transporter Base. It will install telapi.dll used to do bulk load on Teradata database.","Make sure the path of the driver and the utilities is in the PATH variable that nlserver will have during execution. By default the path is C:\\Program Files (x86)\\Teradata\\Client\\15.10\\bin on Windows 32 bits or C:\\Program Files\\Teradata\\Client\\15.10\\bin on 64 bit).","Time zone","Teradata uses time zone name that are not standard, you can find the list on the Teradata site. Adobe Campaign will try to convert the time zone given in the external configuration to something Teradata understand. If a correspondence is not found, the closet GMT+X (or GMT-X) time zone will be found for the session, with a warning in the log.","The conversion is done reading a file called teradata_timezones.txt that should be in the following datakit directory: /usr/local/neolane/nl6/datakit under linux. If you edit this file, make sure to contact the Adobe Campaign team to make the change in the source code otherwise this file will be overwritten during next Campaign update.","The time zone used to connect will be indicated when running nlserver with the -verbose switch, for example:","15:04:04 >   ODB-240007 Teradata: will use 'Europe Central' as session time zone.","If the time zone used is not the correct one, an option named \"TimeZoneName\" can be added on the external account. In that case, use the Teradata Value, for example \"TimeZoneName=Europe Central\".","When using bulk load, or \"fast load\" in Teradata documents, Campaign can't indicate the time zone. Therefore, it is recommended to set the default time zone of the user that Campaign will use to connect:"]},{"section":"Compatibility","sectionId":"c3c358d4-9add-4c3d-b24e-a4f0e59eafc4","paragraphs":["Configure access to Teradata","Use Campaign Federated Data Access (FDA) option to process information stored in an external databases. Follow the steps below to configure access to Teradata.","Install and configure Teradata drivers\nConfigure the Teradata external account in Campaign\nSet up additional configuration for Teradata and Campaign server","Teradata configuration","You need to install drivers for Teradata to have connection to Campaign implemented.","Install the ODBC driver for Teradata.","It is made up of three packages that can be installed on Red Hat (or CentOS)/Suse in the following order:","TeraGSS\ntdicu1510 (install it using setup_wrapper.sh)\ntdodbc1510 (install it using setup_wrapper.sh)","Configure the ODBC driver. The configuration can be carried out in the standard files: /etc/odbc.ini for general parameters and /etc/odbcinst.ini for declaring drivers:","/etc/odbc.ini","[ODBC]\nInstallDir=/etc/","\"InstallDir\" corresponds to the location of the odbcinst.ini file.","/etc/odbcinst.ini","[ODBC DRIVERS]\nteradata=Installed","[teradata]\nDriver=/opt/teradata/client/17.10/lib64/tdataodbc_sb64.so\nAPILevel=CORE\nConnectFunctions=YYY\nDriverODBCVer=3.51\nSQLLevel=1","Specify the environment variables of the Adobe Campaign server:","LD_LIBRARY_PATH: /opt/teradata/client/15.10/lib64 and /opt/teradata/client/15.10/odbc_64/lib.\nODBCINI: location of the odbc.ini file (for example /etc/odbc.ini).\nNLSPATH: location of the opermsgs.cat file (/opt/teradata/client/15.10/msg/opermsgs.cat)","NOTE","Connecting to a Teradata external database in FDA requires additional configurations steps on the Adobe Campaign server. Learn more.","Teradata external account","The Teradata external account allows you to connect your Campaign instance to your Teradata external database.","From Campaign Explorer, click Administration / Platform / External accounts.","Click New and select External database as Type.","","To configure the Teradata external account, you must specify:","Type: Choose the Teradata type.","Server: URL or name of your Teradata server","Account: Name of the account used to access the Teradata database","Password: Password used to connect to the Teradata database","Database: Name of the database (optional)","Options: Options to be passed through Teradata. Use the following format: 'parameter=value'. Use a semicolon as separator between values.","Timezone: Timezone set in Teradata. Learn more","The connector supports the following options:","Option Description\nTD_MAX_SESSIONS Specifies the maximum number of logon sessions that the Teradata Parallel Transporter can acquire for an operator job.\nTimeZoneName Name of the server time zone.\nCharacterSet Used to configure Teradata character set. For more on this, refer to this page.\nIANAAppCodePage ODBC application code page. For more on this, refer to this page","Add additional ODBC external accounts","NOTE","This option is not available for builds older than the 7.3.1 version.","The Teradata driver provides its own ODBC library but this library may not be compatible with other ODBC external accounts.","If you want to configure another external account that also uses ODBC, e.g. Snowflake, you will need to add an ODBCLib option set to the path of the default ODBC library (/usr/lib/x86_64-linux-gnu/libodbc.so on Debian and /usr/lib64/libodbc.so on RHEL/CentOS).","Query banding","When multiple Adobe Campaign users connect to the same FDA Teradata external account, the Query banding tab allows you to set a query band, i.e. a set of key/value pairs, on a session.","When this option is configured, each time a Campaign user performs a query on the Teradata database, Adobe Campaign will send meta data, which consists of a list of keys, associated to this user. This data can then be used by Teradata administrators for audit purposes or to manage access rights.","NOTE","For more information on Query banding, refer to the Teradata documentation.","To configure Query banding, follow the steps below:","Use the  Default to enter a default query band that will be used if a user has no associated query band. If this field is left empty, the users with no query band will not be able to use Teradata.","Use the Users field to specify a query band for each user. You can add as many key/value pairs as you need e.g. priority=1;workload=high. If the user has no query band assigned, the Default field will be applied.","Check the Active box to activate this feature","External account troubleshooting","If the following error appears while testing the connection TIM-030008 Date '2': missing character(s) (iRc=-53) make sure that the ODBC driver is correctly installed and that the LD_LIBRARY_PATH (Linux) / PATH (Windows) is set for the Campaign server.","The error ODB-240000 ODBC error: [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified. occurs with Windows if you use a 16.X driver. Adobe Campaign expects the teradata to be named '' in odbcinst.ini.","Starting Campaign 18.10, you can add ODBCDriverName=\"Teradata Database ODBC Driver 16.10\" in the options of the external account. The version number can change, the exact name can be found by running odbcad32.exe and accessing to the Drivers tab.","If you are using an older Campaign version, you will have to copy the Teradata section of odbcinst.ini created by the driver installation to a new section called Teradata. Regedit can be used in this case. If your base is in latin1, you will have to add APICharSize=1 in the options.","Additional configurations"]},{"section":"User configuration","sectionId":"03ad6ee2-650a-4f7c-ab0a-284086b15469","paragraphs":["The following rights are required on the external database: create/drop/execute custom procedures, create/drop/insert/select tables. You may also have to create user mode functions if you want to use md5 and sha2 function on your Adobe Campaign instance.","Make sure to configure the correct time zone. It should match what will be set in the external account created in the Adobe Campaign instance.","Adobe Campaign will not set a protection mode (fallback) on the objects it will create in the database. You might need to set a default on the user that Adobe Campaign will use to connect to the Teradata database using the following query:","disable default fallback\nMODIFY USER $login$ AS NO FALLBACK;"]},{"section":"MD5 installation","sectionId":"30fe3948-b5e3-4a45-8371-0dc351af5732","paragraphs":["If you want to use md5 functions in your Adobe Campaign instance, you will have to install the user mode function on your Teradata database from this page (md5_20080530.zip).","The sha1 of the downloaded file is as follows 65cc0bb6935f72fcd84fef1ebcd64c00115dfd1e.","To install md5:","Unzip the md5_20080530.zip file.","Go to the md5/src directory.","Connect to your Teradata database using bteq.","Run the following bteq command:",".run file = hash_md5.btq"]},{"section":"SHA2 installation","sectionId":"39efac22-0711-4e79-a27d-7654be721c7f","paragraphs":["If you want to use sha2 functions in your Adobe Campaign instance, you will have to install the user mode function on your Teradata database from this page (teradata-udf-sha2-1.0.zip).","The sha1 of the downloaded file is as follows e87438d37424836358bd3902cf1adeb629349780.","To install sha2:","Unzip the teradata-udf-sha2-1.0.zip file.","Go to the teradata-udf-sha2-1.0/src directory.","Connect to your Teradata database using bteq.","Run the two following bteq commands:",".run file = hash_sha256.sql\n.run file = hash_sha512.sql"]},{"section":"UDF_UTF16TO8 installation","sectionId":"8c532976-d5d8-4ef2-97a7-1b0b09693f01","paragraphs":["If you want to use udf_utf16to8 functions in your Adobe Campaign instance, install the user mode function on your Teradata database from the Teradata unicode tool kit.","The sha1 of the downloaded file is as follows e58235f434f52c71316a577cb48e20b97d24f470.","To install udf_utf16to8:","Unzip the utk_release1.7.0.0.zip file.","Look for the udf_utf16to8.o in the extracted files and navigate to the directory that contains the file. It should be named utk_release1.7.0.0/utk_release1.7.0.0/04 TranslationUDFs/01 Teradata UDFs/suselinux-x8664/udf_installation/.","Connect to your Teradata database using bteq.","Type in the following bteq command:","REPLACE FUNCTION udf_utf16to8 (\ninputString VARCHAR(8000) CHARACTER SET UNICODE\n) RETURNS VARCHAR(16000) CHARACTER SET LATIN\nLANGUAGE C\nNO SQL\nEXTERNAL NAME 'CO!i18n103!udf_utf16to8.o!F!udf_utf16to8'\nPARAMETER STYLE SQL;","-- Test: should return 410042\nSELECT CAST(Char2HexInt(UDF_UTF16to8(_UNICODE'004100000042'XC)) AS VARCHAR(100));"]},{"section":"Campaign server configuration for Linux","sectionId":"3d4fbeb2-ff98-4e53-b724-8f3f9578d236","paragraphs":["The following is required for the driver installation:","Teradata ODBC Driver, which can be found in this page","Teradata Tools and Utilities (used for the bulk load), which can be found in this page","File names and sha1:","tdodbc1620__linux_indep.16.20.00.00-1.tar.gz 121fdd978b56fe1304fc5cb7819741b0847f44fd","TeradataToolsAndUtilitiesBase__linux_indep.16.20.01.00.tar.gz b 29d0af5ffd8dcf68a9dbbaa6f8639387b19c563","If there is no package for your Linux distribution, you can install as explained on a CentOS 7 (for example using docker) and then copy the content of the /opt/teradata on your Adobe Campaign server."]},{"section":"ODBC driver installation","sectionId":"d00338a4-2e3d-4855-a15f-ab1361b8f88f","paragraphs":["To install ODBC driver:","Extract the tdodbc1620__linux_indep.16.20.00.00-1.tar.gz file.","Go to the tdodbc1620 directory.","You might need to fix the setup script:","\"sed -i s/16.10/16.20/ setup_wrapper.sh\".","Run the setup_wrapper.sh."]},{"section":"Teradata tools and utilities installation","sectionId":"fbe4e6c3-4d42-480f-8e9d-75e67f3ccf3d","paragraphs":["To install Tools:","Extract the TeradataToolsAndUtilitiesBase__linux_indep.16.20.01.00.tar.gz file.","Go to the TeradataToolsAndUtilitiesBase/Linux/i386-x8664/tdicu directory.","Run the setup_wrapper.sh.","Go to the TeradataToolsAndUtilitiesBase/Linux/i386-x8664/cliv2 directory.","Run the setup_wrapper.sh.","Go to the TeradataToolsAndUtilitiesBase/Linux/i386-x8664/tptbase directory.","Run the setup_wrapper.sh.","A libtelapi.so file should be available in /opt/teradata/client/16.20/lib64."]},{"section":"Campaign server configuration for Windows","sectionId":"dd5f7df0-19fc-4ce4-a654-06c3f432ee01","paragraphs":["You first need to download Teradata Tools and utilities for Windows. You can download it from this page","Make sure to install the ODBC driver and the Teradata Parallel Transporter Base. It will install telapi.dll used to do bulk load on Teradata database.","Make sure the path of the driver and the utilities is in the PATH variable that nlserver will have during execution. By default the path is C:\\Program Files (x86)\\Teradata\\Client\\15.10\\bin on Windows 32 bits or C:\\Program Files\\Teradata\\Client\\15.10\\bin on 64 bit)."]},{"section":"Time zone","sectionId":"4b7f0229-f98c-496a-b5d6-3d2fde9e2aae","paragraphs":["Teradata uses time zone name that are not standard, you can find the list on the Teradata site. Adobe Campaign will try to convert the time zone given in the external configuration to something Teradata understand. If a correspondence is not found, the closet GMT+X (or GMT-X) time zone will be found for the session, with a warning in the log.","The conversion is done reading a file called teradata_timezones.txt that should be in the following datakit directory: /usr/local/neolane/nl6/datakit under linux. If you edit this file, make sure to contact the Adobe Campaign team to make the change in the source code otherwise this file will be overwritten during next Campaign update.","The time zone used to connect will be indicated when running nlserver with the -verbose switch, for example:","15:04:04 >   ODB-240007 Teradata: will use 'Europe Central' as session time zone.","If the time zone used is not the correct one, an option named \"TimeZoneName\" can be added on the external account. In that case, use the Teradata Value, for example \"TimeZoneName=Europe Central\".","When using bulk load, or \"fast load\" in Teradata documents, Campaign can't indicate the time zone. Therefore, it is recommended to set the default time zone of the user that Campaign will use to connect:","MODIFY USER $login$ AS TIME ZONE = 'Europe Central';"]}]}