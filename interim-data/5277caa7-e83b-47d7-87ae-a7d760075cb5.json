{"guid":"5277caa7-e83b-47d7-87ae-a7d760075cb5","title":"Control rules","path":"help\\campaign-opt\\using\\control-rules.md","fullText":"---\nproduct: campaign\ntitle: Control rules\ndescription: Learn how to work with control rules in Adobe Campaign\nrole: User, Data Engineer\nfeature: Typology Rules, Campaigns\nexl-id: 5a5f26f6-38da-4488-aadb-81fcb5359331\n---\n# Control rules{#control-rules}\n\n## Analysis and arbitration control rules {#analysis-and-arbitration-control-rules}\n\nControl rules let you guarantee the validity and quality of messages prior to delivery: character display, SMS size, address format, etc.\n\nA set of out-of-the-box rules lets you carry out usual checks. These checks (shown in bold in the interface) are:\n\n* **[!UICONTROL Object approval]** (email): checks that the sender object and address do not contain special characters which may cause problems on certain mail agents.\n* **[!UICONTROL URL label approval]** (email): checks that each tracking URL has a label.\n* **[!UICONTROL URL approval]** (email): checks the tracking URLs (presence of the \"&\" character).\n* **[!UICONTROL Message size approval]** (mobile): checks the size of SMS messages.\n* **[!UICONTROL Validity period check]** (email): checks that the validity period of the delivery is long enough to send all messages.\n* **[!UICONTROL Proof size check]** (all channels): generates an error message if the proof target population exceeds 100 recipients.\n* **[!UICONTROL Wave scheduling check]** (email): checks that the last wave of deliveries is scheduled to start before the end of the validity period, if the delivery is broken down into several waves.\n* **[!UICONTROL Unsubscription link approval]** (email): checks for the presence of at least one unsubscription (opt-out) URL in each content (HTML and Text).\n\n## Creating a control rule {#creating-a-control-rule}\n\nIt is possible to create new control rules to suit your needs. To do this, create a **[!UICONTROL Control]** typology rule and enter the control formula in SQL in the **[!UICONTROL Code]** tab.\n\n**Example:**\n\nIn the following example, we are going to create a rule to prevent an SMS offer from being sent to more than 100 recipients. This rule will be linked to a campaign typology, then to the SMS deliveries for which the concerned offer is available.\n\nApply the following steps:\n\n1. Create a **[!UICONTROL Control]** typology rule. Select a **[!UICONTROL Warning]** alert level. \n\n   ![](assets/campaign_opt_create_control_01.png)\n\n1. In the **[!UICONTROL Code]** tab, enter the script to apply the desired threshold, as shown below:\n\n   ![](assets/campaign_opt_create_control_02.png)\n\n   This script will trigger a warning if the delivery target exceeds 100 contacts:\n\n   ```\n   if( delivery.FCP == false && delivery.properties.toDeliver > 100 ) { logWarning(\"Significant number of SMS to deliver (\" + delivery.properties.toDeliver + \"). Please make sure the target is correct.\") return false; } return true\n   ```\n\n1. Link this rule to a campaign typology and reference the typology in the concerned SMS delivery.\n\n   ![](assets/campaign_opt_create_control_03.png)\n\n1. During delivery analysis, the rule is applied and a warning is created if applicable.\n\n   ![](assets/campaign_opt_create_control_04.png)\n\n   However, the delivery will still be ready for sending.\n\n   If you increase the alert level, this will prevent the delivery from starting.\n\n   ![](assets/campaign_opt_create_control_05.png)\n\n   At the end of the analysis, the **[!UICONTROL Confirm delivery]** button will not be available.\n\n   ![](assets/campaign_opt_create_control_06.png)\n","headers":[["title","Control rules"],["description","Learn how to work with control rules in Adobe Campaign"],["feature","Typology Rules, Campaigns"]],"sections":[{"section":"Control rules","sectionId":"e95d9435-dd5b-4a8b-86f8-864f5442718e","paragraphs":[]},{"section":"Analysis and arbitration control rules","sectionId":"438cd429-fbd9-4a45-9c64-85b6def61339","paragraphs":["Control rules let you guarantee the validity and quality of messages prior to delivery: character display, SMS size, address format, etc.","A set of out-of-the-box rules lets you carry out usual checks. These checks (shown in bold in the interface) are:","Object approval (email): checks that the sender object and address do not contain special characters which may cause problems on certain mail agents.\nURL label approval (email): checks that each tracking URL has a label.\nURL approval (email): checks the tracking URLs (presence of the \"&\" character).\nMessage size approval (mobile): checks the size of SMS messages.\nValidity period check (email): checks that the validity period of the delivery is long enough to send all messages.\nProof size check (all channels): generates an error message if the proof target population exceeds 100 recipients.\nWave scheduling check (email): checks that the last wave of deliveries is scheduled to start before the end of the validity period, if the delivery is broken down into several waves.\nUnsubscription link approval (email): checks for the presence of at least one unsubscription (opt-out) URL in each content (HTML and Text)."]},{"section":"Creating a control rule","sectionId":"4aa7ec22-b6f1-49ec-90ca-36381d0400f6","paragraphs":["It is possible to create new control rules to suit your needs. To do this, create a Control typology rule and enter the control formula in SQL in the Code tab.","Example:","In the following example, we are going to create a rule to prevent an SMS offer from being sent to more than 100 recipients. This rule will be linked to a campaign typology, then to the SMS deliveries for which the concerned offer is available.","Apply the following steps:","Create a Control typology rule. Select a Warning alert level.","In the Code tab, enter the script to apply the desired threshold, as shown below:","This script will trigger a warning if the delivery target exceeds 100 contacts:","if( delivery.FCP == false && delivery.properties.toDeliver > 100 )  return true","Link this rule to a campaign typology and reference the typology in the concerned SMS delivery.","During delivery analysis, the rule is applied and a warning is created if applicable.","However, the delivery will still be ready for sending.","If you increase the alert level, this will prevent the delivery from starting.","At the end of the analysis, the Confirm delivery button will not be available."]}]}