{"guid":"cd7f313f-4eaf-46c6-b8d9-0b06f0d58ff4","title":"Examples of schemas edition","path":"help\\configuration\\using\\examples-of-schemas-edition.md","fullText":"---\nproduct: campaign\ntitle: Examples of schemas edition\ndescription: Examples of schemas edition\nfeature: Schema Extension\nrole: Data Engineer, Developer\nexl-id: b7ee70e0-89c6-4cd3-8116-2f073d4a2f2f\n---\n\n# Examples of schemas edition{#examples-of-schemas-edition}\n\n## Extend a table {#extending-a-table}\n\nTo extend the **nms:recipient** schema recipient table, apply the following procedure:\n\n1. Create the extension schema (**cus:extension**) using the following data:\n\n   ```\n   <srcSchema mappingType=\"sql\" name=\"extension\" namespace=\"cus\" xtkschema=\"xtk:srcSchema\" extendedSchema=\"nms:recipient\">  \n     <enumeration basetype=\"string\" default=\"area1\" name=\"area\">    \n       <value label=\"Zone 1\" name=\"area1\"/>    \n       <value label=\"Zone 2\" name=\"area2\"/>  \n     </enumeration>  \n   \n     <element name=\"extension\">    \n       <dbindex name=\"area\">      \n         <keyfield xpath=\"location/@area\"/>    \n       </dbindex>      \n   \n       <attribute label=\"Loyalty code\" name=\"fidelity\" type=\"long\"/>    \n       <element name=\"location\">      \n         <attribute name=\"area\" label=\"Purchasing zone\" type=\"string\" length=\"50\" enum=\"area\"/>    \n       </element>  </element>  \n   </srcSchema>\n   ```\n\n   In this example, an indexed field (**fidelity**) is added, and the **location** element (which already existed in the **nms:recipient** schema) is supplemented with an enumerated field (**area**).\n\n   >[!IMPORTANT]\n   >\n   >Remember to add the **extendedSchema** attribute to reference the extension schema.\n\n1. Check that the extended schema is the **nms:recipient** schema and that the additional data is present:\n\n   ```\n   <schema dependingSchemas=\"cus:extension\" mappingType=\"sql\" name=\"recipient\" namespace=\"nms\" xtkschema=\"xtk:schema\">\n     ...\n     <enumeration basetype=\"string\" default=\"area1\" name=\"area\">    \n       <value label=\"Zone 1\" name=\"area1\"/>    \n       <value label=\"Zone 2\" name=\"area2\"/>  \n     </enumeration>\n     ...\n     <element autopk=\"true\" name=\"recipient\" sqltable=\"NmsRecipient\"> \n       <dbindex name=\"area\">      \n         <keyfield xpath=\"location/@area\"/>    \n       </dbindex>\n   \n       ...\n       <attribute belongsTo=\"cus:extension\" label=\"Loyalty code\" name=\"fidelity\" sqlname=\"iFidelity\" type=\"long\"/>\n       <element name=\"location\">\n         ...\n         <attribute enum=\"area\" label=\"Purchasing zone\" length=\"50\" name=\"area\" sqlname=\"sArea\" type=\"string\"/>\n       </element>\n       ...\n     </element>\n   </schema>\n   ```\n\n   The SQL script generated from the database update wizard is as follows:\n\n   ```\n   ALTER TABLE NmsRecipient ADD iFidelity INTEGER;\n   UPDATE NmsRecipient SET iFidelity = 0;\n   ALTER TABLE NmsRecipient ALTER COLUMN iFidelity SET NOT NULL;ALTER TABLE NmsRecipient ALTER COLUMN iFidelity SET Default 0;\n   ALTER TABLE NmsRecipient ADD sArea VARCHAR(50); \n   CREATE INDEX NmsRecipient_area ON NmsRecipient(sArea);\n   ```\n\n## Linked collection table {#linked-collection-table}\n\nThis section describes how to create an order table linked to the recipient table with cardinality 1-N.\n\nOrder table source schema:\n\n```\n<srcSchema label=\"Order\" name=\"order\" namespace=\"cus\" xtkschema=\"xtk:srcSchema\">  \n  <element autopk=\"true\" name=\"order\">    \n    <compute-string expr=\"@number\" + '(' + ToString(@date) + ')'/>    \n    \n    <attribute label=\"Number\" length=\"128\" name=\"number\" type=\"string\"/>    \n    <attribute desc=\"Order date\" label=\"Date\" name=\"date\" type=\"datetime\" default=\"GetDate()\"/>    \n    <attribute desc=\"order total\" label=\"Total\" name=\"total\" type=\"double\"/>    \n    <element label=\"Recipient\" name=\"recipient\" revDesc=\"Orders associated with this recipient\" revIntegrity=\"own\" revLabel=\"Orders\" target=\"nms:recipient\" type=\"link\"/>  \n  </element>\n</srcSchema>\n```\n\nThe table type is **autopk** in order to create an auto-generated primary key to be used by the join of the link to the recipient table.\n\nSchema generated:\n\n```\n<schema label=\"Order\" mappingType=\"sql\" name=\"order\" namespace=\"cus\" xtkschema=\"xtk:schema\">  \n  <element autopk=\"true\" label=\"Order\" name=\"order\" sqltable=\"CusOrder\">    \n    <compute-string expr=\"ToString(@date) + ' - ' + @number\"/>    \n\n    <dbindex name=\"id\" unique=\"true\">      \n      <keyfield xpath=\"@id\"/>    \n    </dbindex>    \n\n    <key internal=\"true\" name=\"id\">      \n      <keyfield xpath=\"@id\"/>    \n    </key>    \n\n    <dbindex name=\"recipientId\">      \n      <keyfield xpath=\"@recipient-id\"/>    \n    </dbindex>    \n\n    <attribute desc=\"Internal primary key\" label=\"Primary key\" name=\"id\" sqlname=\"iOrderId\" type=\"long\"/>    \n    <attribute label=\"Number\" length=\"128\" name=\"number\" sqlname=\"sNumber\" type=\"string\"/>    \n    <attribute desc=\"Order date\" label=\"Date\" name=\"date\" sqlname=\"tsDate\" type=\"datetime\"/>    \n    <attribute desc=\"order total\" label=\"Total\" name=\"total\" sqlname=\"Total\" type=\"double\"/>    \n    <element label=\"Recipient\" name=\"recipient\" revLink=\"order\" target=\"nms:recipient\" type=\"link\">      \n      <join xpath-dst=\"@id\" xpath-src=\"@recipient-id\"/>    \n    </element>    \n    <attribute advanced=\"true\" label=\"Foreign key of 'Recipient' link ('id' field)\" name=\"recipient-id\" sqlname=\"iRecipientId\" type=\"long\"/>  \n   </element>\n</schema>\n```\n\nThe table creation SQL script is as follows:\n\n```\nCREATE TABLE CusOrder(dTotal DOUBLE PRECISION NOT NULL Default 0, iOrderId INTEGER NOT NULL Default 0, iRecipientId INTEGER NOT NULL Default 0, sNumber VARCHAR(128), tsDate TIMESTAMP Default NULL);\nCREATE UNIQUE INDEX CusOrder_id ON CusOrder(iOrderId);\nCREATE INDEX CusOrder_recipientId ON CusOrder(iRecipientId);  \nINSERT INTO CusOrder (iOrderId) VALUES (0); \n```\n\n>[!NOTE]\n>\n>The SQL command INSERT INTO at the end of the script lets you insert an identifier record set to 0 in order to simulate outer joins.\n\n## Extension table {#extension-table}\n\nAn extension table lets you extend the content of an existing table in a linked table of cardinality 1-1.\n\nThe purpose of an extension table is to avoid limitations on the number of fields supported in a table, or to optimize the space occupied by the data, which is consumed on demand.\n\nCreating the extension table schema (**cus:feature**):\n\n```\n<srcSchema mappingType=\"sql\" name=\"feature\" namespace=\"cus\" xtkschema=\"xtk:srcSchema\">  \n  <element autopk=\"true\" name=\"feature\">    \n    <attribute label=\"Children\" name=\"children\" type=\"byte\"/>    \n    <attribute label=\"Single\" name=\"single\" type=\"boolean\"/>    \n    <attribute label=\"Spouse first name\" length=\"100\" name=\"spouseFirstName\" type=\"string\"/>  \n  </element>\n</srcSchema>\n```\n\nCreating an extension schema on the recipient table to add the link of cardinality 1-1:\n\n```\n<srcSchema extendedSchema=\"nms:recipient\" label=\"Recipient\" mappingType=\"sql\" name=\"recipient\" namespace=\"cus\" xtkschema=\"xtk:srcSchema\">  \n  <element name=\"recipient\">    \n    <element desc=\"Features\" integrity=\"own\" label=\"Features\" name=\"feature\" revCardinality=\"single\" revLink=\"recipient\" target=\"cus:feature\" type=\"link\"/> \n  </element>\n</srcSchema>\n```\n\n>[!NOTE]\n>\n>The definition of the link between the recipient table and the extension table must be populated from the schema containing the foreign key.\n\nThe SQL script for creating the extension table is as follows:\n\n```\nCREATE TABLE CusFeature(  iChildren NUMERIC(3) NOT NULL Default 0, iFeatureId INTEGER NOT NULL Default 0, iSingle NUMERIC(3) NOT NULL Default 0, sSpouseFirstName VARCHAR(100));\nCREATE UNIQUE INDEX CusFeature_id ON CusFeature(iFeatureId);  \nINSERT INTO CusFeature (iFeatureId) VALUES (0); \n```\n\nThe recipient table SQL update script is as follows:\n\n```\nALTER TABLE NmsRecipient ADD iFeatureId INTEGER;\nUPDATE NmsRecipient SET iFeatureId = 0;\nALTER TABLE NmsRecipient ALTER COLUMN iFeatureId SET NOT NULL;\nALTER TABLE NmsRecipient ALTER COLUMN iFeatureId SET Default 0;\nCREATE INDEX NmsRecipient_featureId ON NmsRecipient(iFeatureId);\n```\n\n## Overflow table {#overflow-table}\n\nAn overflow table is an extension table (cardinality 1-1), but the declaration of the link to the table to be extended is populated in the schema of the overflow table.\n\nThe overflow table contains the foreign key to the table to be extended. The table to be extended is therefore not modified. The relation between the two tables is the value of the primary key of the table to be extended.\n\nCreating the overflow table schema (**cus:overflow**):\n\n```\n<srcSchema label=\"Overflow\" name=\"overflow\" namespace=\"cus\" xtkschema=\"xtk:srcSchema\">  \n  <element name=\"overflow\">    \n    <key internal=\"true\" name=\"id\">      \n      <keyfield xlink=\"recipient\"/>    \n    </key>    \n\n    <attribute label=\"Children\" name=\"children\" type=\"byte\"/>    \n    <attribute label=\"Single\" name=\"single\" type=\"boolean\"/>    \n    <attribute label=\"Spouse first name\" length=\"100\" name=\"spouseFirstName\" type=\"string\"/>  \n    <element label=\"Customer\" name=\"recipient\" revCardinality=\"single\" revIntegrity=\"own\" revExternalJoin=\"true\" target=\"nms:recipient\" type=\"link\"/>  \n  </element>  \n</srcSchema>\n```\n\n>[!NOTE]\n>\n>The primary key of the overflow table is the link to the table to be extended (\"nms:recipient\" schema in our example).\n\nThe table creation SQL script is as follows:\n\n```\nCREATE TABLE CusOverflow(iChildren NUMERIC(3) NOT NULL Default 0, iRecipientId INTEGER NOT NULL Default 0, iSingle NUMERIC(3) NOT NULL Default 0, sSpouseFirstName VARCHAR(100));\nCREATE UNIQUE INDEX CusOverflow2_id ON CusOverflow2(iRecipientId);  \n```\n\n## Relationship table {#relationship-table}\n\nA relationship table lets you link two tables with cardinality N-N. This table contains only the foreign keys of the tables to be linked.\n\nExample of a relationship table between groups (**nms:group**) and recipients (**nms:recipient**).\n\nSource schema of the relationship table:\n\n```\n<srcSchema name=\"rcpGrpRel\" namespace=\"cus\">\n  <element name=\"rcpGrpRel\">\n    <key internal=\"true\" name=\"id\">      \n      <keyfield xlink=\"rcpGroup\"/>      \n      <keyfield xlink=\"recipient\"/>    \n    </key>\n\n    <element integrity=\"neutral\" label=\"Recipient\" name=\"recipient\" revDesc=\"Groups to which this recipient belongs\" revIntegrity=\"own\" revLabel=\"Groups\" target=\"nms:recipient\" type=\"link\"/>    \n    <element integrity=\"neutral\" label=\"Group\" name=\"rcpGroup\" revDesc=\"Recipients in the group\" revIntegrity=\"own\" revLabel=\"Recipients\" revLink=\"rcpGrpRel\" target=\"nms:group\" type=\"link\"/>\n  </element>\n</srcSchema>\n```\n\nThe schema generated is as follows:\n\n```\n<schema mappingType=\"sql\" name=\"rcpGrpRel\" namespace=\"cus\" xtkschema=\"xtk:schema\">  \n  <element name=\"rcpGrpRel\" sqltable=\"CusRcpGrpRel\">    \n    <compute-string expr=\"ToString([@rcpGroup-id]) + ',' + ToString([@recipient-id])\"/>    \n    <dbindex name=\"id\" unique=\"true\">      \n      <keyfield xpath=\"@rcpGroup-id\"/>      \n      <keyfield xpath=\"@recipient-id\"/>    \n    </dbindex>    \n\n    <key internal=\"true\" name=\"id\">      \n      <keyfield xpath=\"@rcpGroup-id\"/>      \n      <keyfield xpath=\"@recipient-id\"/>    \n    </key>    \n\n    <dbindex name=\"rcpGroupId\">      \n      <keyfield xpath=\"@rcpGroup-id\"/>    \n    </dbindex>    \n    <dbindex name=\"recipientId\">      \n      <keyfield xpath=\"@recipient-id\"/>    \n    </dbindex>    \n\n    <element integrity=\"neutral\" label=\"Recipient\" name=\"recipient\" revLink=\"rcpGrpRel\" target=\"nms:recipient\" type=\"link\">      \n      <join xpath-dst=\"@id\" xpath-src=\"@recipient-id\"/>    \n    </element>    \n    <attribute advanced=\"true\" label=\"Foreign key of 'Recipient' link ('id' field)\" name=\"recipient-id\" sqlname=\"iRecipientId\" type=\"long\"/>    \n\n    <element integrity=\"neutral\" label=\"Group\" name=\"rcpGroup\" revLink=\"rcpGrpRel\" target=\"nms:group\" type=\"link\">      \n      <join xpath-dst=\"@id\" xpath-src=\"@rcpGroup-id\"/>    \n    </element>    \n    <attribute advanced=\"true\" label=\"Foreign key of 'Group' link ('id' field)\" name=\"rcpGroup-id\" sqlname=\"iRcpGroupId\" type=\"long\"/>  \n  </element>\n</schema>\n```\n\nThe table creation SQL script is as follows:\n\n```\nCREATE TABLE CusRcpGrpRel( iRcpGroupId INTEGER NOT NULL Default 0, iRecipientId INTEGER NOT NULL Default 0);\nCREATE UNIQUE INDEX CusRcpGrpRel_id ON CusRcpGrpRel(iRcpGroupId, iRecipientId);\nCREATE INDEX CusRcpGrpRel_recipientId ON CusRcpGrpRel(iRecipientId);\n```\n\n## Use Case: link a field to an existing reference table {#uc-link}\n\nThis use case demonstrates how you can use an existing reference table as an alternative to built-in Adobe Campaign enumeration mechanisms (enum, userEnum, or dbEnum).\n\nYou can also use an existing reference table as an enumeration in your schemas. This can be achieved by creating a link between a table and the reference table, and by adding the attribute **displayAsField=\"true\"**.\n\nIn this example, the reference table contains a list of bank names and identifiers:\n\n```\n<srcSchema entitySchema=\"xtk:srcSchema\" img=\"cus:bank16x16.png\" label=\"Bank\" mappingType=\"sql\" name=\"bank\" namespace=\"cus\"\nxtkschema=\"xtk:srcSchema\">\n    <element img=\"cus:bank16x16.png\" label=\"Banks\" name=\"bank\">\n        <compute-string expr=\"@name\"/>\n        <key name=\"id\">\n            <keyfield xpath=\"@id\"/>\n        </key>\n        <attribute label=\"Bank Id\" name=\"id\" type=\"short\"/>\n        <attribute label=\"Name\" length=\"64\" name=\"name\" type=\"string\"/>\n     </element> \n</srcSchema>\n```\n\nIn any table using this reference table, define a link and add the **displayAsField=\"true\"** attribute.\n\n```\n<element displayAsField=\"true\" label=\"Bank\" name=\"bank\" target=\"cus:bank\" type=\"link\" noDbIndex=\"true\"/>\n```\n\nThe user interface will not display a link but a field. When users pick that field, they can select a value from the reference table or use the auto-complete feature.\n\n![](assets/schema-edition-ex.png)\n\n* In order for it to auto-complete, you must define a compute-string in the reference table.\n\n* Add the **noDbIndex=\"true\"** attribute in the link definition to prevent Adobe Campaign from creating an index on the values stored in the source table of the link.\n\n## Related topics\n\n* [Working with enumerations](../../platform/using/managing-enumerations.md)\n\n* [Get Started with Campaign schemas](../../configuration/using/about-schema-edition.md)\n\n* [Updating the database structure](../../configuration/using/updating-the-database-structure.md)\n","headers":[["title","Examples of schemas edition"],["description","Examples of schemas edition"],["feature","Schema Extension"]],"sections":[{"section":"Examples of schemas edition","sectionId":"28c62262-5f53-440b-89c0-76187b78a14f","paragraphs":[]},{"section":"Extend a table","sectionId":"81171330-5fd1-4225-b2a5-3c7eb2bc538f","paragraphs":["To extend the nms:recipient schema recipient table, apply the following procedure:","Create the extension schema (cus:extension) using the following data:","<srcSchema mappingType=\"sql\" name=\"extension\" namespace=\"cus\" xtkschema=\"xtk:srcSchema\" extendedSchema=\"nms:recipient\">  \n  <enumeration basetype=\"string\" default=\"area1\" name=\"area\">    \n    <value label=\"Zone 1\" name=\"area1\"/>    \n    <value label=\"Zone 2\" name=\"area2\"/>  \n  </enumeration>","<element name=\"extension\">    \n    <dbindex name=\"area\">      \n      <keyfield xpath=\"location/@area\"/>    \n    </dbindex>","<attribute label=\"Loyalty code\" name=\"fidelity\" type=\"long\"/>    \n    <element name=\"location\">      \n      <attribute name=\"area\" label=\"Purchasing zone\" type=\"string\" length=\"50\" enum=\"area\"/>    \n    </element>  </element>  \n</srcSchema>","In this example, an indexed field (fidelity) is added, and the location element (which already existed in the nms:recipient schema) is supplemented with an enumerated field (area).","IMPORTANT","Remember to add the extendedSchema attribute to reference the extension schema.","Check that the extended schema is the nms:recipient schema and that the additional data is present:","<schema dependingSchemas=\"cus:extension\" mappingType=\"sql\" name=\"recipient\" namespace=\"nms\" xtkschema=\"xtk:schema\">\n  ...\n  <enumeration basetype=\"string\" default=\"area1\" name=\"area\">    \n    <value label=\"Zone 1\" name=\"area1\"/>    \n    <value label=\"Zone 2\" name=\"area2\"/>  \n  </enumeration>\n  ...\n  <element autopk=\"true\" name=\"recipient\" sqltable=\"NmsRecipient\"> \n    <dbindex name=\"area\">      \n      <keyfield xpath=\"location/@area\"/>    \n    </dbindex>","...\n    <attribute belongsTo=\"cus:extension\" label=\"Loyalty code\" name=\"fidelity\" sqlname=\"iFidelity\" type=\"long\"/>\n    <element name=\"location\">\n      ...\n      <attribute enum=\"area\" label=\"Purchasing zone\" length=\"50\" name=\"area\" sqlname=\"sArea\" type=\"string\"/>\n    </element>\n    ...\n  </element>\n</schema>","The SQL script generated from the database update wizard is as follows:","ALTER TABLE NmsRecipient ADD iFidelity INTEGER;\nUPDATE NmsRecipient SET iFidelity = 0;\nALTER TABLE NmsRecipient ALTER COLUMN iFidelity SET NOT NULL;ALTER TABLE NmsRecipient ALTER COLUMN iFidelity SET Default 0;\nALTER TABLE NmsRecipient ADD sArea VARCHAR(50); \nCREATE INDEX NmsRecipient_area ON NmsRecipient(sArea);"]},{"section":"Linked collection table","sectionId":"a84da8eb-c6dc-4770-a241-d151902c5368","paragraphs":["This section describes how to create an order table linked to the recipient table with cardinality 1-N.","Order table source schema:","<srcSchema label=\"Order\" name=\"order\" namespace=\"cus\" xtkschema=\"xtk:srcSchema\">  \n  <element autopk=\"true\" name=\"order\">    \n    <compute-string expr=\"@number\" + '(' + ToString(@date) + ')'/>    \n    \n    <attribute label=\"Number\" length=\"128\" name=\"number\" type=\"string\"/>    \n    <attribute desc=\"Order date\" label=\"Date\" name=\"date\" type=\"datetime\" default=\"GetDate()\"/>    \n    <attribute desc=\"order total\" label=\"Total\" name=\"total\" type=\"double\"/>    \n    <element label=\"Recipient\" name=\"recipient\" revDesc=\"Orders associated with this recipient\" revIntegrity=\"own\" revLabel=\"Orders\" target=\"nms:recipient\" type=\"link\"/>  \n  </element>\n</srcSchema>","The table type is autopk in order to create an auto-generated primary key to be used by the join of the link to the recipient table.","Schema generated:","<schema label=\"Order\" mappingType=\"sql\" name=\"order\" namespace=\"cus\" xtkschema=\"xtk:schema\">  \n  <element autopk=\"true\" label=\"Order\" name=\"order\" sqltable=\"CusOrder\">    \n    <compute-string expr=\"ToString(@date) + ' - ' + @number\"/>","<dbindex name=\"id\" unique=\"true\">      \n      <keyfield xpath=\"@id\"/>    \n    </dbindex>","<key internal=\"true\" name=\"id\">      \n      <keyfield xpath=\"@id\"/>    \n    </key>","<dbindex name=\"recipientId\">      \n      <keyfield xpath=\"@recipient-id\"/>    \n    </dbindex>","<attribute desc=\"Internal primary key\" label=\"Primary key\" name=\"id\" sqlname=\"iOrderId\" type=\"long\"/>    \n    <attribute label=\"Number\" length=\"128\" name=\"number\" sqlname=\"sNumber\" type=\"string\"/>    \n    <attribute desc=\"Order date\" label=\"Date\" name=\"date\" sqlname=\"tsDate\" type=\"datetime\"/>    \n    <attribute desc=\"order total\" label=\"Total\" name=\"total\" sqlname=\"Total\" type=\"double\"/>    \n    <element label=\"Recipient\" name=\"recipient\" revLink=\"order\" target=\"nms:recipient\" type=\"link\">      \n      <join xpath-dst=\"@id\" xpath-src=\"@recipient-id\"/>    \n    </element>    \n    <attribute advanced=\"true\" label=\"Foreign key of 'Recipient' link ('id' field)\" name=\"recipient-id\" sqlname=\"iRecipientId\" type=\"long\"/>  \n   </element>\n</schema>","The table creation SQL script is as follows:","CREATE TABLE CusOrder(dTotal DOUBLE PRECISION NOT NULL Default 0, iOrderId INTEGER NOT NULL Default 0, iRecipientId INTEGER NOT NULL Default 0, sNumber VARCHAR(128), tsDate TIMESTAMP Default NULL);\nCREATE UNIQUE INDEX CusOrder_id ON CusOrder(iOrderId);\nCREATE INDEX CusOrder_recipientId ON CusOrder(iRecipientId);  \nINSERT INTO CusOrder (iOrderId) VALUES (0);","NOTE","The SQL command INSERT INTO at the end of the script lets you insert an identifier record set to 0 in order to simulate outer joins."]},{"section":"Extension table","sectionId":"81048708-5a9b-4bdd-b214-87cc4e4bab32","paragraphs":["An extension table lets you extend the content of an existing table in a linked table of cardinality 1-1.","The purpose of an extension table is to avoid limitations on the number of fields supported in a table, or to optimize the space occupied by the data, which is consumed on demand.","Creating the extension table schema (cus:feature):","<srcSchema mappingType=\"sql\" name=\"feature\" namespace=\"cus\" xtkschema=\"xtk:srcSchema\">  \n  <element autopk=\"true\" name=\"feature\">    \n    <attribute label=\"Children\" name=\"children\" type=\"byte\"/>    \n    <attribute label=\"Single\" name=\"single\" type=\"boolean\"/>    \n    <attribute label=\"Spouse first name\" length=\"100\" name=\"spouseFirstName\" type=\"string\"/>  \n  </element>\n</srcSchema>","Creating an extension schema on the recipient table to add the link of cardinality 1-1:","<srcSchema extendedSchema=\"nms:recipient\" label=\"Recipient\" mappingType=\"sql\" name=\"recipient\" namespace=\"cus\" xtkschema=\"xtk:srcSchema\">  \n  <element name=\"recipient\">    \n    <element desc=\"Features\" integrity=\"own\" label=\"Features\" name=\"feature\" revCardinality=\"single\" revLink=\"recipient\" target=\"cus:feature\" type=\"link\"/> \n  </element>\n</srcSchema>","NOTE","The definition of the link between the recipient table and the extension table must be populated from the schema containing the foreign key.","The SQL script for creating the extension table is as follows:","CREATE TABLE CusFeature(  iChildren NUMERIC(3) NOT NULL Default 0, iFeatureId INTEGER NOT NULL Default 0, iSingle NUMERIC(3) NOT NULL Default 0, sSpouseFirstName VARCHAR(100));\nCREATE UNIQUE INDEX CusFeature_id ON CusFeature(iFeatureId);  \nINSERT INTO CusFeature (iFeatureId) VALUES (0);","The recipient table SQL update script is as follows:","ALTER TABLE NmsRecipient ADD iFeatureId INTEGER;\nUPDATE NmsRecipient SET iFeatureId = 0;\nALTER TABLE NmsRecipient ALTER COLUMN iFeatureId SET NOT NULL;\nALTER TABLE NmsRecipient ALTER COLUMN iFeatureId SET Default 0;\nCREATE INDEX NmsRecipient_featureId ON NmsRecipient(iFeatureId);"]},{"section":"Overflow table","sectionId":"05e21c51-6326-4fba-a51b-c4cbd1af7293","paragraphs":["An overflow table is an extension table (cardinality 1-1), but the declaration of the link to the table to be extended is populated in the schema of the overflow table.","The overflow table contains the foreign key to the table to be extended. The table to be extended is therefore not modified. The relation between the two tables is the value of the primary key of the table to be extended.","Creating the overflow table schema (cus:overflow):","<srcSchema label=\"Overflow\" name=\"overflow\" namespace=\"cus\" xtkschema=\"xtk:srcSchema\">  \n  <element name=\"overflow\">    \n    <key internal=\"true\" name=\"id\">      \n      <keyfield xlink=\"recipient\"/>    \n    </key>","<attribute label=\"Children\" name=\"children\" type=\"byte\"/>    \n    <attribute label=\"Single\" name=\"single\" type=\"boolean\"/>    \n    <attribute label=\"Spouse first name\" length=\"100\" name=\"spouseFirstName\" type=\"string\"/>  \n    <element label=\"Customer\" name=\"recipient\" revCardinality=\"single\" revIntegrity=\"own\" revExternalJoin=\"true\" target=\"nms:recipient\" type=\"link\"/>  \n  </element>  \n</srcSchema>","NOTE","The primary key of the overflow table is the link to the table to be extended (\"nms:recipient\" schema in our example).","The table creation SQL script is as follows:","CREATE TABLE CusOverflow(iChildren NUMERIC(3) NOT NULL Default 0, iRecipientId INTEGER NOT NULL Default 0, iSingle NUMERIC(3) NOT NULL Default 0, sSpouseFirstName VARCHAR(100));\nCREATE UNIQUE INDEX CusOverflow2_id ON CusOverflow2(iRecipientId);"]},{"section":"Relationship table","sectionId":"629847c9-54cc-46bb-9437-eef89fb7db03","paragraphs":["A relationship table lets you link two tables with cardinality N-N. This table contains only the foreign keys of the tables to be linked.","Example of a relationship table between groups (nms:group) and recipients (nms:recipient).","Source schema of the relationship table:","<srcSchema name=\"rcpGrpRel\" namespace=\"cus\">\n  <element name=\"rcpGrpRel\">\n    <key internal=\"true\" name=\"id\">      \n      <keyfield xlink=\"rcpGroup\"/>      \n      <keyfield xlink=\"recipient\"/>    \n    </key>","<element integrity=\"neutral\" label=\"Recipient\" name=\"recipient\" revDesc=\"Groups to which this recipient belongs\" revIntegrity=\"own\" revLabel=\"Groups\" target=\"nms:recipient\" type=\"link\"/>    \n    <element integrity=\"neutral\" label=\"Group\" name=\"rcpGroup\" revDesc=\"Recipients in the group\" revIntegrity=\"own\" revLabel=\"Recipients\" revLink=\"rcpGrpRel\" target=\"nms:group\" type=\"link\"/>\n  </element>\n</srcSchema>","The schema generated is as follows:","<schema mappingType=\"sql\" name=\"rcpGrpRel\" namespace=\"cus\" xtkschema=\"xtk:schema\">  \n  <element name=\"rcpGrpRel\" sqltable=\"CusRcpGrpRel\">    \n    <compute-string expr=\"ToString([@rcpGroup-id]) + ',' + ToString([@recipient-id])\"/>    \n    <dbindex name=\"id\" unique=\"true\">      \n      <keyfield xpath=\"@rcpGroup-id\"/>      \n      <keyfield xpath=\"@recipient-id\"/>    \n    </dbindex>","<key internal=\"true\" name=\"id\">      \n      <keyfield xpath=\"@rcpGroup-id\"/>      \n      <keyfield xpath=\"@recipient-id\"/>    \n    </key>","<dbindex name=\"rcpGroupId\">      \n      <keyfield xpath=\"@rcpGroup-id\"/>    \n    </dbindex>    \n    <dbindex name=\"recipientId\">      \n      <keyfield xpath=\"@recipient-id\"/>    \n    </dbindex>","<element integrity=\"neutral\" label=\"Recipient\" name=\"recipient\" revLink=\"rcpGrpRel\" target=\"nms:recipient\" type=\"link\">      \n      <join xpath-dst=\"@id\" xpath-src=\"@recipient-id\"/>    \n    </element>    \n    <attribute advanced=\"true\" label=\"Foreign key of 'Recipient' link ('id' field)\" name=\"recipient-id\" sqlname=\"iRecipientId\" type=\"long\"/>","<element integrity=\"neutral\" label=\"Group\" name=\"rcpGroup\" revLink=\"rcpGrpRel\" target=\"nms:group\" type=\"link\">      \n      <join xpath-dst=\"@id\" xpath-src=\"@rcpGroup-id\"/>    \n    </element>    \n    <attribute advanced=\"true\" label=\"Foreign key of 'Group' link ('id' field)\" name=\"rcpGroup-id\" sqlname=\"iRcpGroupId\" type=\"long\"/>  \n  </element>\n</schema>","The table creation SQL script is as follows:","CREATE TABLE CusRcpGrpRel( iRcpGroupId INTEGER NOT NULL Default 0, iRecipientId INTEGER NOT NULL Default 0);\nCREATE UNIQUE INDEX CusRcpGrpRel_id ON CusRcpGrpRel(iRcpGroupId, iRecipientId);\nCREATE INDEX CusRcpGrpRel_recipientId ON CusRcpGrpRel(iRecipientId);"]},{"section":"Use Case: link a field to an existing reference table","sectionId":"0660a429-deb1-4bce-9799-0bf1150fc2ee","paragraphs":["This use case demonstrates how you can use an existing reference table as an alternative to built-in Adobe Campaign enumeration mechanisms (enum, userEnum, or dbEnum).","You can also use an existing reference table as an enumeration in your schemas. This can be achieved by creating a link between a table and the reference table, and by adding the attribute displayAsField=\"true\".","In this example, the reference table contains a list of bank names and identifiers:","<srcSchema entitySchema=\"xtk:srcSchema\" img=\"cus:bank16x16.png\" label=\"Bank\" mappingType=\"sql\" name=\"bank\" namespace=\"cus\"\nxtkschema=\"xtk:srcSchema\">\n    <element img=\"cus:bank16x16.png\" label=\"Banks\" name=\"bank\">\n        <compute-string expr=\"@name\"/>\n        <key name=\"id\">\n            <keyfield xpath=\"@id\"/>\n        </key>\n        <attribute label=\"Bank Id\" name=\"id\" type=\"short\"/>\n        <attribute label=\"Name\" length=\"64\" name=\"name\" type=\"string\"/>\n     </element> \n</srcSchema>","In any table using this reference table, define a link and add the displayAsField=\"true\" attribute.","<element displayAsField=\"true\" label=\"Bank\" name=\"bank\" target=\"cus:bank\" type=\"link\" noDbIndex=\"true\"/>","The user interface will not display a link but a field. When users pick that field, they can select a value from the reference table or use the auto-complete feature.","In order for it to auto-complete, you must define a compute-string in the reference table.","Add the noDbIndex=\"true\" attribute in the link definition to prevent Adobe Campaign from creating an index on the values stored in the source table of the link."]},{"section":"Related topics","sectionId":"5e898b44-aad0-48e4-8398-7a4014f6a4bd","paragraphs":["Working with enumerations","Get Started with Campaign schemas","Updating the database structure"]}]}