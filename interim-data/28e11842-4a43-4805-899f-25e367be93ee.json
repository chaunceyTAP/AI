{"guid":"28e11842-4a43-4805-899f-25e367be93ee","title":"Campaign - Microsoft Dynamics CRM Connector","path":"help\\platform\\using\\crm-ms-dynamics.md","fullText":"---\nproduct: campaign\ntitle: Campaign - Microsoft Dynamics CRM Connector\ndescription: Learn how to connect Campaign and Microsoft Dynamics\nfeature: Microsoft CRM Integration\nexl-id: 26737940-b3ce-425c-9604-f4cefd19afaa\n---\n# Connect Campaign and Microsoft Dynamics 365{#connect-to-msdyn}\n\n\n   \nIn this page, you will  learn how to connect Campaign Classic to **Microsoft Dynamics CRM 365**.\n\nPossible deployment is via **Web API** (recommended). Refer to [the section below](#microsoft-dynamics-implementation-step) to learn steps to set up the connection with Microsoft Dynamics.\n\nData synchronization is carried out via a dedicated workflow activity. [Learn more](../../platform/using/crm-data-sync.md).\n\n## Implementation steps{#microsoft-dynamics-implementation-steps}\n\nTo connect Microsoft Dynamics 365 to work with Adobe Campaign via **Web API**, you need to apply the following steps:\n\nIn Microsoft Dynamics CRM:\n1. Get Microsoft Dynamics Client ID\n1. Generate Microsoft Dynamics Certificate key identifier and Key ID\n1. Configure permissions\n1. Create an App User\n1. Encode the private key\n\n[Learn more in this section](#config-crm-microsoft)\n\nIn Campaign Classic:\n1. Create a new external account\n1. Configure the external account with Microsoft Dynamics settings\n1. Use the configuration wizard to map tables and synchronize enumerations\n1. Create the synchronization workflow\n\n[Learn more in this section](#configure-acc-for-microsoft)\n\n\n>[!CAUTION]\n> When connecting Adobe Campaign with Microsoft Dynamics, you cannot:\n> * Install plug-ins which can change the CRM's behavior, and lead to compatibility issues with Adobe Campaign\n> * Select multiple enumerations\n\n## Configure Microsoft Dynamics CRM {#config-crm-microsoft}\n\nTo generate the access token and keys to setup the account, you need to login to [Microsoft Azure Directory](https://portal.azure.com) using a **Global administrator** credentials. Then follow the steps outlined below.\n\n### Get Microsoft Dynamics Client ID {#get-client-id-microsoft}\n\nTo get the Client ID, you need to register an App in Azure Active Directory. Client ID is the same as Application ID. \n\n1. Navigate to **Azure Active Directory > App Registrations**, and click  **New Application Registration**.\n1. Give a unique name which can help identify an instance, such as **adobecampaign`<instance identifier>`**.\n1. Choose **Application type** as **Web app / API**.\n1. Use `http://localhost` for **Sign-on URL**.\n\nOnce you save, you get an **Application ID** which is the Client Identifier for Campaign.\n\nLearn more in [this page](https://docs.microsoft.com/powerapps/developer/common-data-service/walkthrough-register-app-azure-active-directory).\n\n### Generate Microsoft Dynamics Certificate key identifier and Key ID {#config-certificate-key-id}\n\nTo get the **Certificate key identifier (customKeyIdentifier)** and the **Key ID (keyId)**, follow the steps below:\n\n1. Navigate to **Azure Active Directory > App Registrations** and select the Application which was created earlier.\n1. Click on **Certificates and Secret**.\n1. Click on **Upload certificate** and then browse and upload your public certificate generated.\n1. To generate the certificate you can use openssl.\n\n   For example:\n\n   ```\n   - openssl req -x509 -sha256 -nodes -days 365 -newkey rsa:2048 -keyout '<'private key name'>' -out '<'public certificate name'>\n   ```\n\n   >[!NOTE]\n   >\n   >You can change the number of days, here `-days 365`, in the code sample for a longer certificate validity period.\n\n1. You will then need to encode it in base64. To do so, you can use the help of a Base64 encoder or use the command line `base64 -w0 private.key` for Linux.\n\n1. Click on the **Manifest** link to get the **Certificate key identifier (customKeyIdentifier)** and the **Key ID (keyId)**.\n\nThe **Certificate key identifier (customKeyIdentifier)** and the **Key ID (keyId)** will be needed later on to configure your Microsoft Dynamics CRM external account using the Certificate **[!UICONTROL CRM O-Auth type]**.\n\n### Configure permissions {#config-permissions-microsoft}\n\n**Step 1**: Configure the **Required Permissions** for the app that was created.\n\n1. Navigate to **Azure Active Directory > App Registrations** and select the Application which was created earlier.\n1. Click **Settings** on the top left.\n1. On **Required Permissions**, click **Add** and **Select an API > Dynamics CRM Online**.\n1. Click **Select**, enable **Access Dynamics 365 as organization users** checkbox and click **Select**.\n1. Then, from your app, select the **Manifest** under the **Manage** menu.\n\n1. From the **Manifest** editor, set the `allowPublicClient` property from `null` to `true` and click **Save**.\n\n**Step 2**: Grant admin consent\n\n1. Navigate to **Azure Active Directory > Enterprise applications**.\n\n1. Select the application to which you want to grant tenant-wide admin consent.\n\n1. From the left pane menu, select **Permissions** under **Security**.\n\n1. Click **Grant admin consent**.\n\nFor more information on this, refer to [Azure documentation](https://docs.microsoft.com/azure/active-directory/manage-apps/grant-admin-consent#grant-admin-consent-from-the-azure-portal).\n\n### Create an App User {#create-app-user-microsoft}\n\n>[!NOTE]\n>\n> This step is optional with **[!UICONTROL Password credentials]** authentication.\n\nThe App user is the user that the application registered above will use. Any changes made to Microsoft Dynamics using the App registered above will be done via this user.\n\n**Step 1**: Create a non-interactive user on azure active directory\n\n1. Click **Azure Active Directory > Users** and click **New User**.\n1. Give a proper name that you want use and the username should be an email format.\n1. Choose **Dynamics 365 Administrator** in the **Directory Role**.\n\n**Step 2**:  Assign a proper license to the created user\n\n1. From [Microsoft Azure](https://portal.azure.com), click on **Admin app**.\n1. Go to **Users > Active Users** and click on the newly created user.\n1. Click on **Edit product licenses** and select the **Dynamics 365 Customer Engagement Plan**.\n1. Click **Close**.\n\n**Step 3**: Create an application user on Dynamics CRM\n\n1. From [Microsoft Azure](https://portal.azure.com), navigate to **Settings > Security > Users**.\n1. Click on drop down, select **Application users** and click **New**.\n1. Use the same username as the user created on active directory above \n\n   >[!NOTE]\n   >\n   >Using the same name throws duplicate key error, so until we get a confirmation as whether this step is needed, use a different username and proceed.\n   >\n\n1. Assign the **Application ID** for [the application you created earlier](#get-client-id-microsoft).\n1. Click on **Manage Roles** and choose the **System administrator** role to the user.\n\n## Configure Campaign {#configure-acc-for-microsoft}\n\n>[!NOTE]\n>\n> Post the decommissioning of [RDS from Microsoft](https://docs.microsoft.com/previous-versions/dynamicscrm-2016/developers-guide/dn281891%28v=crm.8%29#microsoft-dynamics-crm-2011-endpoint), the On-premise and Office 365 types of CRM deployments are no longer compatible with Campaign. Adobe Campaign now only supports Web API deployment for the CRM version **Dynamic CRM 365**. [Learn more](../../rn/using/deprecated-features.md#crm-connectors).\n\nTo connect Microsoft Dynamics 365 and Campaign, you need to create and configure a dedicated **[!UICONTROL External Account]** in Campaign.\n\n1. Navigate to **[!UICONTROL Administration > Platform > External accounts]**.\n\n1. Select the **[!UICONTROL Microsoft Dynamics CRM]** external account. Check the **[!UICONTROL Enabled]** option.\n\n1. Fill in the information required to connect Microsoft Dynamics 365 and Campaign.\n\n   >[!NOTE]\n   >\n   >Microsoft Dynamics CRM External account configuration with each **[!UICONTROL CRM O-Auth type]** is detailed [in this section](../../installation/using/external-accounts.md#microsoft-dynamics-crm-external-account).\n\n   ![](assets/crm-ms-dynamics-ext-account.png)\n\n1. Click the **[!UICONTROL Microsoft CRM configuration wizard...]** link. Adobe Campaign automatically detects the tables from the Microsoft Dynamics data template.\n\n   ![](assets/crm_connectors_msdynamics_02.png)\n\n1. Select the tables to be recovered.\n\n   ![](assets/crm_connectors_msdynamics_03.png)\n\n1. Click **[!UICONTROL Next]** to start creating the corresponding schema.\n\n   ![](assets/crm_connectors_msdynamics_04.png)\n\n   >[!NOTE]\n   >\n   >To approve the configuration, you must disconnect/reconnect to the Adobe Campaign console.\n\n   You can check that the matching data schema becomes available in Adobe Campaign.\n\n   ![](assets/crm_connectors_msdynamics_05.png)\n\n1. Click the **[!UICONTROL Synchronizing enumerations...]** link to start synchronizing enumerations between Adobe Campaign and Microsoft Dynamics.\n\n   ![](assets/crm_connectors_msdynamics_06.png)\n\nCampaign and Microsoft Dynamics are now connected. You can set up data synchronization between the two systems. Learn more in the [Data synchronization](../../platform/using/crm-data-sync.md) section.\n\n>[!NOTE]\n>\n> You need to make sure to add to the allowlist two URLs: the server URL and `login.microsoftonline.com` in the Server configuration. For more information on how to configure URL permissions, refer to this [page](../../installation/using/url-permissions.md).\n\n## Supported field data types {#ms-dyn-supported-types}\n\nFor Microsoft Dynamics 365 supported/unsupported attribute types are listed below:\n\n\n| Attribute  type                                                                   | Supported |\n| --------------------------------------------------------------------------------- | --------- |\n| Basic types : boolean, datetime, decimal, float, double, integer, bigint , string | Yes       |\n| Money (as double)                                                                 | Yes       |\n| memo, entityname , primarykey, uniqueidentifier (as strings)                      | Yes       |\n| Status, picklist (we store the possible values in enumerations), state (string)   | Yes       |\n| owner (as string)                                                                 | Yes       |\n| Lookup (only single entity reference lookups)                                     | Yes       |\n| customer                                                                          | No        |\n| Regarding                                                                         | No        |\n| PartyList                                                                         | No        |\n| ManagedProperty                                                                   | No        |\n| MultiSelect Option Set                                                            | No        |\n","headers":[["title","Campaign - Microsoft Dynamics CRM Connector"],["description","Learn how to connect Campaign and Microsoft Dynamics"],["feature","Microsoft CRM Integration"]],"sections":[{"section":"Connect Campaign and Microsoft Dynamics 365","sectionId":"0f64f713-d04a-4e14-a0d9-d080bd0786a6","paragraphs":["In this page, you will  learn how to connect Campaign Classic to Microsoft Dynamics CRM 365.","Possible deployment is via Web API (recommended). Refer to the section below to learn steps to set up the connection with Microsoft Dynamics.","Data synchronization is carried out via a dedicated workflow activity. Learn more."]},{"section":"Implementation steps","sectionId":"7020cff4-48d8-4fe2-a26d-bba63a9420aa","paragraphs":["To connect Microsoft Dynamics 365 to work with Adobe Campaign via Web API, you need to apply the following steps:","In Microsoft Dynamics CRM:","Get Microsoft Dynamics Client ID\nGenerate Microsoft Dynamics Certificate key identifier and Key ID\nConfigure permissions\nCreate an App User\nEncode the private key","Learn more in this section","In Campaign Classic:","Create a new external account\nConfigure the external account with Microsoft Dynamics settings\nUse the configuration wizard to map tables and synchronize enumerations\nCreate the synchronization workflow","Learn more in this section","CAUTION\nWhen connecting Adobe Campaign with Microsoft Dynamics, you cannot:","Install plug-ins which can change the CRM's behavior, and lead to compatibility issues with Adobe Campaign\nSelect multiple enumerations"]},{"section":"Configure Microsoft Dynamics CRM","sectionId":"447720eb-e281-495e-ae95-13365b09bceb","paragraphs":["To generate the access token and keys to setup the account, you need to login to Microsoft Azure Directory using a Global administrator credentials. Then follow the steps outlined below."]},{"section":"Get Microsoft Dynamics Client ID","sectionId":"cd62dc32-767a-4631-8e05-8199d7beea7a","paragraphs":["To get the Client ID, you need to register an App in Azure Active Directory. Client ID is the same as Application ID.","Navigate to Azure Active Directory > App Registrations, and click  New Application Registration.\nGive a unique name which can help identify an instance, such as adobecampaign<instance identifier>.\nChoose Application type as Web app / API.\nUse http://localhost for Sign-on URL.","Once you save, you get an Application ID which is the Client Identifier for Campaign.","Learn more in this page."]},{"section":"Generate Microsoft Dynamics Certificate key identifier and Key ID","sectionId":"ca8f3448-da1a-4d14-a0ce-1c824fafa496","paragraphs":["To get the Certificate key identifier (customKeyIdentifier) and the Key ID (keyId), follow the steps below:","Navigate to Azure Active Directory > App Registrations and select the Application which was created earlier.","Click on Certificates and Secret.","Click on Upload certificate and then browse and upload your public certificate generated.","To generate the certificate you can use openssl.","For example:","- openssl req -x509 -sha256 -nodes -days 365 -newkey rsa:2048 -keyout '<'private key name'>' -out '<'public certificate name'>","NOTE","You can change the number of days, here -days 365, in the code sample for a longer certificate validity period.","You will then need to encode it in base64. To do so, you can use the help of a Base64 encoder or use the command line base64 -w0 private.key for Linux.","Click on the Manifest link to get the Certificate key identifier (customKeyIdentifier) and the Key ID (keyId).","The Certificate key identifier (customKeyIdentifier) and the Key ID (keyId) will be needed later on to configure your Microsoft Dynamics CRM external account using the Certificate CRM O-Auth type."]},{"section":"Configure permissions","sectionId":"03a38ed1-90a1-45d1-b9b3-78e747e53e2e","paragraphs":["Step 1: Configure the Required Permissions for the app that was created.","Navigate to Azure Active Directory > App Registrations and select the Application which was created earlier.","Click Settings on the top left.","On Required Permissions, click Add and Select an API > Dynamics CRM Online.","Click Select, enable Access Dynamics 365 as organization users checkbox and click Select.","Then, from your app, select the Manifest under the Manage menu.","From the Manifest editor, set the allowPublicClient property from null to true and click Save.","Step 2: Grant admin consent","Navigate to Azure Active Directory > Enterprise applications.","Select the application to which you want to grant tenant-wide admin consent.","From the left pane menu, select Permissions under Security.","Click Grant admin consent.","For more information on this, refer to Azure documentation."]},{"section":"Create an App User","sectionId":"b7fa11c1-158c-4887-9f02-42cbe3c12e0c","paragraphs":["NOTE","This step is optional with Password credentials authentication.","The App user is the user that the application registered above will use. Any changes made to Microsoft Dynamics using the App registered above will be done via this user.","Step 1: Create a non-interactive user on azure active directory","Click Azure Active Directory > Users and click New User.\nGive a proper name that you want use and the username should be an email format.\nChoose Dynamics 365 Administrator in the Directory Role.","Step 2:  Assign a proper license to the created user","From Microsoft Azure, click on Admin app.\nGo to Users > Active Users and click on the newly created user.\nClick on Edit product licenses and select the Dynamics 365 Customer Engagement Plan.\nClick Close.","Step 3: Create an application user on Dynamics CRM","From Microsoft Azure, navigate to Settings > Security > Users.","Click on drop down, select Application users and click New.","Use the same username as the user created on active directory above","NOTE","Using the same name throws duplicate key error, so until we get a confirmation as whether this step is needed, use a different username and proceed.","Assign the Application ID for the application you created earlier.","Click on Manage Roles and choose the System administrator role to the user."]},{"section":"Configure Campaign","sectionId":"9e5a2265-fcf6-4987-a98a-eaafce76ac63","paragraphs":["NOTE","Post the decommissioning of RDS from Microsoft, the On-premise and Office 365 types of CRM deployments are no longer compatible with Campaign. Adobe Campaign now only supports Web API deployment for the CRM version Dynamic CRM 365. Learn more.","To connect Microsoft Dynamics 365 and Campaign, you need to create and configure a dedicated External Account in Campaign.","Navigate to Administration > Platform > External accounts.","Select the Microsoft Dynamics CRM external account. Check the Enabled option.","Fill in the information required to connect Microsoft Dynamics 365 and Campaign.","NOTE","Microsoft Dynamics CRM External account configuration with each CRM O-Auth type is detailed in this section.","Click the Microsoft CRM configuration wizard... link. Adobe Campaign automatically detects the tables from the Microsoft Dynamics data template.","Select the tables to be recovered.","Click Next to start creating the corresponding schema.","NOTE","To approve the configuration, you must disconnect/reconnect to the Adobe Campaign console.","You can check that the matching data schema becomes available in Adobe Campaign.","Click the Synchronizing enumerations... link to start synchronizing enumerations between Adobe Campaign and Microsoft Dynamics.","Campaign and Microsoft Dynamics are now connected. You can set up data synchronization between the two systems. Learn more in the Data synchronization section.","NOTE","You need to make sure to add to the allowlist two URLs: the server URL and login.microsoftonline.com in the Server configuration. For more information on how to configure URL permissions, refer to this page."]},{"section":"Supported field data types","sectionId":"a73704e1-08db-4a0c-bb01-e6a0d4a6e521","paragraphs":["For Microsoft Dynamics 365 supported/unsupported attribute types are listed below:","Attribute  type Supported\nBasic types : boolean, datetime, decimal, float, double, integer, bigint , string Yes\nMoney (as double) Yes\nmemo, entityname , primarykey, uniqueidentifier (as strings) Yes\nStatus, picklist (we store the possible values in enumerations), state (string) Yes\nowner (as string) Yes\nLookup (only single entity reference lookups) Yes\ncustomer No\nRegarding No\nPartyList No\nManagedProperty No\nMultiSelect Option Set No"]}]}