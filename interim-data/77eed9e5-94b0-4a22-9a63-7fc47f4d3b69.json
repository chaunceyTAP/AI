{"guid":"77eed9e5-94b0-4a22-9a63-7fc47f4d3b69","title":"Additional configurations","path":"help\\message-center\\using\\additional-configurations.md","fullText":"---\nproduct: campaign\ntitle: Additional configurations\ndescription: Learn how to set up additional configurations for Transactional messaging in Adobe Campaign Classic\nfeature: Transactional Messaging, Message Center\naudience: message-center\ncontent-type: reference\ntopic-tags: instance-configuration\nexl-id: 4d25d740-db57-4d18-8cae-2dd49c4a786e\n---\n# Additional configurations {#mc-additional-configurations}\n\n\n\n## Monitor thresholds {#monitoring-thresholds}\n\nYou can configure the warning thresholds (orange) and alert thresholds (red) of the indicators that appear in the **Message Center service level** and **Message Center processing time** reports (refer to [Access transactional messaging reports](../../message-center/using/about-transactional-messaging-reports.md)).\n\nTo do this, follow the steps below:\n\n1. Open the deployment wizard on the **execution instance**.\n\n1. Go to the **[!UICONTROL Message Center]** page.\n\n1. Use the arrows to change the thresholds.\n\n    ![](assets/messagecenter_monitor_events_001.png)\n\n>[!NOTE]\n>\n>The number of events pending in queue is displayed in the [System indicators](../../production/using/monitoring-processes.md#system-indicators) section of the Adobe Campaign process monitoring page. For more information on the deployment wizard, refer to [this section](../../installation/using/deploying-an-instance.md#deployment-wizard).\n\n## Purge events {#purging-events}\n\nYou can use the [deployment wizard](../../production/using/database-cleanup-workflow.md#deployment-wizard) to configure how long the data is to be stored in the database.\n\nEvent purging is carried out automatically by the [Database cleanup workflow](../../production/using/database-cleanup-workflow.md). This workflow purges the events received and stored on the execution instances and events archived on a control instance.\n\nUse the arrows as appropriate to change the purge settings.\n\nEvent purge settings on a control instance:\n\n![](assets/messagecenter_delete_events_001.png)\n\nEvent purge settings on an execution instance:\n\n![](assets/messagecenter_delete_events_002.png)\n\nFor more on the database cleanup workflow, see [this section](../../production/using/database-cleanup-workflow.md).\n\n\n## Technical workflows {#technical-workflows}\n\nYou must ensure that the technical workflows on the control instance and the different execution instances have indeed been created and started before deploying any transactional message templates.\n\nThe various technical workflows related to transactional messaging (Message Center) are broken down between the control instance and the execution instance(s).\n\n### Control instance workflows {#control-instance-workflows}\n\nOn the control instance, whether you have one or several execution instances registered, you must create one archiving workflow for each **[!UICONTROL Message Center execution instance]** external account. Click the **[!UICONTROL Create the archiving workflow]** button to create and start the workflow.\n\n![](assets/messagecenter_archiving_002.png)\n\nThese workflows can then be accessed from the **Administration > Production > Message Center** folder. Once created, the archiving workflows are automatically started.\n\n<!--**Minimal architecture**\n\nOnce the control and execution modules are installed on the same instance, you must create the archiving workflow using the deployment wizard. Click the **[!UICONTROL Create the archiving workflow]** button to create and start the workflow.\n\n![](assets/messagecenter_archiving_001.png)-->\n\n### Execution instance workflows {#execution-instance-workflows}\n\nOn the execution instance(s), the technical workflows for transactional messaging can be accessed from the **Administration > Production > Message Center** folder. You just have to start them. The workflows in the list are:\n\n* **[!UICONTROL Processing batch events]** (internal name: **[!UICONTROL batchEventsProcessing]** ): this workflow lets you break down batch events in a queue before they are linked to a message template.\n* **[!UICONTROL Processing real time events]** (internal name: **[!UICONTROL rtEventsProcessing]** ): this workflow lets you break down real time events in a queue before they are linked to a message template.\n* **[!UICONTROL Update event status]** (internal name: **[!UICONTROL updateEventStatus]** ): this workflow lets you attribute a status to the event.\n\n  The following event statuses are available:\n\n    * **[!UICONTROL Pending]** : the event is in the queue. No message template has been assigned to it yet.\n    * **[!UICONTROL Pending delivery]** : the event is in the queue, a message template has been assigned to it and it is being processed by the delivery.\n    * **[!UICONTROL Sent]** : this status is copied from the delivery logs. It means that the delivery has been sent.\n    * **[!UICONTROL Ignored by the delivery]** : this status is copied from the delivery logs. It means that the delivery was ignored.\n    * **[!UICONTROL Delivery failed]** : this status is copied from the delivery logs. It means that the delivery failed.\n    * **[!UICONTROL Event not taken into account]** : the event could not be linked to a message template. The event will not be processed.\n\n### Archiving workflow schedule\n\nAvoid modifying the **archiving workflow** schedule that runs on the control instance. Otherwise some tracking data being pulled from the execution instance may be lost.\n\nIf you do modify the archiving workflow schedule, you must also change the **tracking workflow** schedule on the execution instance to match the archiving workflow schedule on the control instance.\n\n## Configure multibranding {#configuring-multibranding}\n\nThis section describes one solution to configure tracking and mirror page URLs per brand, for transactional messages in Adobe Campaign.\n\n### Prerequisites {#prerequisites}\n\n* All of the hosts must be added to the configuration file of the instance (`config-<instance>.xml`).\n* Each brand must be assigned a sub-domain.\n* You must have an HTTPS certificate for all brands if the web tracking is done on HTTPS pages.\n\nTo configure multibranding, you need to configure both execution instances and control instance.\n\n### Execution instance {#execution-instance}\n\nOn the execution instance(s), follow the steps below:\n\n1. Create one external account per brand.\n\n   >[!NOTE]\n   >\n   >Learn how to create an execution instance type external account in [this section](../../message-center/using/configuring-instances.md#control-instance).\n\n1. Extend the nms:extAccount schema to add the tracking URL:\n\n   ```\n   <attribute advanced=\"true\" desc=\"URL of the tracking servers\" label=\"Tracking server URL\"\n   length=\"100\" name=\"trackingURL\" type=\"string\"/>\n   ```\n\n   >[!NOTE]\n   >\n   >Learn how to extend an existing schema in the [Extending a schema](../../configuration/using/extending-a-schema.md) section.\n\n1. Modify the nms:extAccount form:\n\n   ```\n   <container label=\"Message domain branding\" type=\"frame\">\n        <static type=\"help\"> These parameters are used to override the DNS alias and addresses used during message delivery. When not populated, the values of the 'NmsServer_MirrorPageUrl' and 'NmsEmail_DefaultErrorAddr' options are used.</static>\n        <input xpath=\"@mirrorURL\"/>\n        <input xpath=\"@trackingURL\"/>\n        <input img=\"nms:sendemail.png\" menuId=\"deliveryMenuBuilder\" type=\"scriptEdit\">\n               xpath=\"errorAddress\"/>\n      </container>\n   ```\n\n1. Modify the NmsTracking_OpenFormula and NmsTracking_ClickFormula options to use the external account instead of a global option.\n\n   To do this, replace:\n\n   ```\n   <%@ include option='NmsTracking_ServerUrl' %>\n   ```\n\n   with:\n\n   ```\n   <%@ value object=\"provider\" xpath=\"@trackingURL\" %>\n   ```\n\n   >[!IMPORTANT]\n   >\n   >These changes could lead to conflicts when upgrading. You may need to manually merge these formulas with their new version.\n\n### Control instance {#control-instance}\n\nOn the control instance, you need to link delivery templates and external accounts.\n\nTo do this, follow the steps below:\n\n1. Create one external account per brand with the same internal name as defined on the [execution instance](#execution-instance) (step 1).\n\n1. Create one default delivery template per brand.\n\n    >[!NOTE]\n    >\n    >    Learn how to create a delivery template in [this section](../../delivery/using/creating-a-delivery-template.md#creating-a-new-template).\n\n1. In the delivery template's **[!UICONTROL Properties]**, set the routing to the external account of the brand.\n","headers":[["title","Additional configurations"],["description","Learn how to set up additional configurations for Transactional messaging in Adobe Campaign Classic"],["feature","Transactional Messaging, Message Center"],["topic-tags","instance-configuration"]],"sections":[{"section":"Additional configurations","sectionId":"6c548f63-16af-45d0-9140-7c1cba8dae85","paragraphs":[]},{"section":"Monitor thresholds","sectionId":"7fccab6b-1f33-4cf0-af6b-4ba0dcd37b2c","paragraphs":["You can configure the warning thresholds (orange) and alert thresholds (red) of the indicators that appear in the Message Center service level and Message Center processing time reports (refer to Access transactional messaging reports).","To do this, follow the steps below:","Open the deployment wizard on the execution instance.","Go to the Message Center page.","Use the arrows to change the thresholds.","NOTE","The number of events pending in queue is displayed in the System indicators section of the Adobe Campaign process monitoring page. For more information on the deployment wizard, refer to this section."]},{"section":"Purge events","sectionId":"a5a572dd-03db-47a4-9501-054352ecc8c9","paragraphs":["You can use the deployment wizard to configure how long the data is to be stored in the database.","Event purging is carried out automatically by the Database cleanup workflow. This workflow purges the events received and stored on the execution instances and events archived on a control instance.","Use the arrows as appropriate to change the purge settings.","Event purge settings on a control instance:","Event purge settings on an execution instance:","For more on the database cleanup workflow, see this section."]},{"section":"Technical workflows","sectionId":"f35b53c7-9648-40d8-8151-0f60dda62f18","paragraphs":["You must ensure that the technical workflows on the control instance and the different execution instances have indeed been created and started before deploying any transactional message templates.","The various technical workflows related to transactional messaging (Message Center) are broken down between the control instance and the execution instance(s)."]},{"section":"Control instance workflows","sectionId":"f99f5733-c45f-49b7-9c23-a994494617ac","paragraphs":["On the control instance, whether you have one or several execution instances registered, you must create one archiving workflow for each Message Center execution instance external account. Click the Create the archiving workflow button to create and start the workflow.","These workflows can then be accessed from the Administration > Production > Message Center folder. Once created, the archiving workflows are automatically started."]},{"section":"Execution instance workflows","sectionId":"6e671ee6-7feb-448e-bed2-49a01ecaed88","paragraphs":["On the execution instance(s), the technical workflows for transactional messaging can be accessed from the Administration > Production > Message Center folder. You just have to start them. The workflows in the list are:","Processing batch events (internal name: batchEventsProcessing ): this workflow lets you break down batch events in a queue before they are linked to a message template.","Processing real time events (internal name: rtEventsProcessing ): this workflow lets you break down real time events in a queue before they are linked to a message template.","Update event status (internal name: updateEventStatus ): this workflow lets you attribute a status to the event.","The following event statuses are available:","Pending : the event is in the queue. No message template has been assigned to it yet.\nPending delivery : the event is in the queue, a message template has been assigned to it and it is being processed by the delivery.\nSent : this status is copied from the delivery logs. It means that the delivery has been sent.\nIgnored by the delivery : this status is copied from the delivery logs. It means that the delivery was ignored.\nDelivery failed : this status is copied from the delivery logs. It means that the delivery failed.\nEvent not taken into account : the event could not be linked to a message template. The event will not be processed."]},{"section":"Archiving workflow schedule","sectionId":"0a4871c3-f424-4e4c-83b2-80ee6e3cc399","paragraphs":["Avoid modifying the archiving workflow schedule that runs on the control instance. Otherwise some tracking data being pulled from the execution instance may be lost.","If you do modify the archiving workflow schedule, you must also change the tracking workflow schedule on the execution instance to match the archiving workflow schedule on the control instance."]},{"section":"Configure multibranding","sectionId":"d7cd7dac-4939-40cf-a531-937d7ea778e3","paragraphs":["This section describes one solution to configure tracking and mirror page URLs per brand, for transactional messages in Adobe Campaign."]},{"section":"Prerequisites","sectionId":"90d9b32d-6e07-4f4b-b191-e96c273e9382","paragraphs":["All of the hosts must be added to the configuration file of the instance (config-<instance>.xml).\nEach brand must be assigned a sub-domain.\nYou must have an HTTPS certificate for all brands if the web tracking is done on HTTPS pages.","To configure multibranding, you need to configure both execution instances and control instance."]},{"section":"Execution instance","sectionId":"bde22817-6ee9-4b40-8bad-03481992f909","paragraphs":["On the execution instance(s), follow the steps below:","Create one external account per brand.","NOTE","Learn how to create an execution instance type external account in this section.","Extend the nms:extAccount schema to add the tracking URL:","<attribute advanced=\"true\" desc=\"URL of the tracking servers\" label=\"Tracking server URL\"\nlength=\"100\" name=\"trackingURL\" type=\"string\"/>","NOTE","Learn how to extend an existing schema in the Extending a schema section.","Modify the nms:extAccount form:","<container label=\"Message domain branding\" type=\"frame\">\n     <static type=\"help\"> These parameters are used to override the DNS alias and addresses used during message delivery. When not populated, the values of the 'NmsServer_MirrorPageUrl' and 'NmsEmail_DefaultErrorAddr' options are used.</static>\n     <input xpath=\"@mirrorURL\"/>\n     <input xpath=\"@trackingURL\"/>\n     <input img=\"nms:sendemail.png\" menuId=\"deliveryMenuBuilder\" type=\"scriptEdit\">\n            xpath=\"errorAddress\"/>\n   </container>","Modify the NmsTracking_OpenFormula and NmsTracking_ClickFormula options to use the external account instead of a global option.","To do this, replace:","<%@ include option='NmsTracking_ServerUrl' %>","with:","<%@ value object=\"provider\" xpath=\"@trackingURL\" %>","IMPORTANT","These changes could lead to conflicts when upgrading. You may need to manually merge these formulas with their new version."]},{"section":"Control instance","sectionId":"8b8fa133-0fd0-48c7-9433-a96e1d6568d8","paragraphs":["On the control instance, you need to link delivery templates and external accounts.","To do this, follow the steps below:","Create one external account per brand with the same internal name as defined on the execution instance (step 1).","Create one default delivery template per brand.","NOTE","Learn how to create a delivery template in this section.","In the delivery template's Properties, set the routing to the external account of the brand."]}]}