{"guid":"9d764269-38cf-432c-bebb-7b94371022a7","title":"Inser web tracking tags in your site","path":"help\\configuration\\using\\inserting-tags-in-your-site.md","fullText":"---\nproduct: campaign\ntitle: Inser web tracking tags in your site\ndescription: Learn how to insert web tracking tags in your site\nfeature: Configuration\nrole: Data Engineer, Developer\nexl-id: e7fcec75-82fe-45ff-8d45-7d6e95baeb14\n---\n# Insert web tracking tags in your site{#inserting-tags-in-your-site}\n\n## Simple method {#simple-method}\n\nThis method consists of sending an HTTP call to the redirection server by inserting an **`<img>`** HTML tag in the HTML source code of the web page you wish to track.\n\n>[!IMPORTANT]\n>\n>This method uses the cookies sent by the web browser to identify the recipient, and is not 100% reliable.\n\n**Example**:\n\n```\n<img height='0' width='0' alt='' src='https://localhost/r/12343?tagid=home'\n```\n\nThe inserted tag contacts the redirection server.\n\n![](assets/d_ncs_integration_webtracking_structure2.png)\n\nWhen you define a page to be tracked in the console, you can generate a sample web tracking tag to copy and paste into the source code of your web page.\n\nWhen you use TRANSACTION-type tags, however, you must modify the sample tag using JavaScript in order to insert the transaction information (amount, number of items) and any information defined by an extension schema.\n\n### Static insertion of tags {#static-insertion-of-tags}\n\nTo perform static tag insertion, simply copy and paste the tags generated by the console or constructed manually into the source of your web page.\n\n**Example**: insertion of a web tracking tag on a page displaying a form.\n\n```\n<html>\n  <...>\n  <body>\n  <script>\n      document.write(\"<img height='0' width='0' alt='' src='https://localhost/r/\" + Math.random().toString() + \"?tagid=home'>\");\n    </script>\n    <noscript>\n     <img height='0' width='0' alt='' src='https://localhost/r/?tagid=home'>\n    </noscript>\n    <h1>My site</h1>\n    <form action=\"http://localhost/amount.md\">\n      Quantity: <input type=\"text\" name=\"quantity\"/><br/><br/>\n      Amount: <input type=\"text\" name=\"amount\"/><br/><br/>\n      <input value=\"Save\" type=\"submit\">\n    </form>\n  </body>\n</html>\n```\n\nInsertion of a TRANSACTION-type web tracking tag in the confirmation page (\"amount.md\").\n\n```\n<html>\n  <body>\n    <script>\n      function getURLparam(name) \n      {\n        var m = location.search.match new RegExp(\"[?&]\" + name + \"=([^&]+)\"));\n        return m ? unescape(m[1]) : \"\";\n      }\n \n       var params = \"https://localhost/r/\" + Math.random().toString() + \"?tagid=amount&amount=\"\n                      +getURLparam(\"amount\")+\"&article=\"+getURLparam(\"quantity\");\n       document.write(\"<img height='0' width='0' src='\"+params+\"'/>\");\n    </script>\n\n    <h1>Approval confirmation</h1>\n  </body>\n</html>\n```\n\n### Dynamic generation of web tracking tags {#dynamic-generation-of-web-tracking-tags}\n\nWhen your web pages are generated dynamically, you can add the web tracking tag at page generation time.\n\n**Example**: Web tracking added to JSPs.\n\n```\n<%@page import=\"java.util.Random\" %>\n<html>\n  <body>\n    <img height='0' width='0' alt='' src='https://localhost/r/<%=new Random().nextInt()%>?tagid=home'>\n    <h1>My site</h1>\n    <form action=\"https://localhost/amount.md\">\n      Quantity: <input type=\"text\" name=\"quantity\"/><br/><br/>\n      Amount: <input type=\"text\" name=\"amount\"/><br/><br/>\n      <input value=\"Save\" type=\"submit\">\n    </form>\n  </body>\n</html>\n```\n\n```\n<%@page import=\"java.util.Random\" %>\n<html>\n  <body>\n    <%  \n      String strParams = new Random().nextInt() + \"?tagid=amount\";\n      strParams += \"&amount=\"+request.getParameter(\"amount\");\n      strParams += \"&article=\"+request.getParameter(\"quantity\");\n    %>\n    <img height='0' width='0' alt=''\n     src='http://localhost/r/<%=strParams%>'>\n    <h1>Approval confirmation</h1>\n    </body>\n</html>\n```\n\n## Optimum method {#optimum-method-}\n\nIf you wish to control the information sent to the redirection server, the most reliable way is to perform the HTTP query synchronously yourself using a page generating language.\n\nThe URL you construct must obey the syntax rules defined in [Web tracking tag: definition](../../configuration/using/web-tracking-tag-definition.md).\n\n![](assets/d_ncs_integration_webtracking_structure3.png)\n\n>[!NOTE]\n>\n>Redirection and web tracking use cookies, and it is important that the web server performing the synchronous HTTP call be in the same domain as the redirection server. The various HTTP exchanges must convey the 'id', 'uuid', and 'uuid230' cookies.\n\n**Example**: Dynamic generation in Java, with recipient authentication using their account number.\n\n```\n[...]\n  // Recipient account, amount and articles\n  String strAccount = request.getParameter(\"account\");\n  String strAmount = request.getParameter(\"amount\");\n  String strArticle = request.getParameter(\"article\");\n\n  StringBuffer strCookies = new StringBuffer();\n  String strSetCookie = null;\n\n  // Get cookies from client request\n  Cookie[] cookies = request.getCookies();\n  for(int i=0; i< cookies.length; i++ )\n  {\n    Cookie c = cookies[i];\n    String strName = c.getName();\n    if( strName.equals(\"id\") || strName.equals(\"uuid\") || strName.equals(\"uuid230\") )\n      // Helper function to add cookies in string\n      AddCookie(strCookies, c);\n  }\n  // Now perform a synchronous HTTP request to inform redirection server\n  // Add a tagid in auto-discover mode, and a default jobId to use (in hexa)\n  StringBuffer strURL = new StringBuffer(\"https://www.adobe.com/r/a?tagid=cmd_page%7Ct&jobid=27EE\");\n  if( strAccount != null )\n    AddParameter(strURL, \"rcpid\", \"saccount=\"+strAccount);\n  if( strAmount != null )\n    AddParameter(strURL, \"amount\", strAmount);\n  if( strArticle != null )\n    AddParameter(strURL, \"article\", strArticle);\n  \n  URL url = new URL(strURL.toString());\n  HttpURLConnection connection = (HttpURLConnection)url.openConnection();\n  // Add the client cookies\n  if( strCookies.length() > 0 )\n    connection.setRequestProperty(\"Cookie\", strCookies.toString());\n\n  int errcode = connection.getResponseCode();\n\n  // Now add the Adobe Campaign cookies if the server returned one :\n  if( errcode == 200 )\n  {\n    strSetCookie = connection.getHeaderField(\"Set-Cookie\");\n    if( strSetCookie != null && strSetCookie.length() > 0 )\n      response.addHeader(\"Set-Cookie\", strSetCookie);\n  }\n  [...]\n```\n","headers":[["title","Inser web tracking tags in your site"],["description","Learn how to insert web tracking tags in your site"],["feature","Configuration"]],"sections":[{"section":"Insert web tracking tags in your site","sectionId":"9bf03b43-d581-4f35-a05f-b73ef523c320","paragraphs":[]},{"section":"Simple method","sectionId":"ff3f0bd7-d49f-4439-b53d-47f1364bbe17","paragraphs":["This method consists of sending an HTTP call to the redirection server by inserting an <img> HTML tag in the HTML source code of the web page you wish to track.","IMPORTANT","This method uses the cookies sent by the web browser to identify the recipient, and is not 100% reliable.","Example:","<img height='0' width='0' alt='' src='https://localhost/r/12343?tagid=home'","The inserted tag contacts the redirection server.","When you define a page to be tracked in the console, you can generate a sample web tracking tag to copy and paste into the source code of your web page.","When you use TRANSACTION-type tags, however, you must modify the sample tag using JavaScript in order to insert the transaction information (amount, number of items) and any information defined by an extension schema."]},{"section":"Static insertion of tags","sectionId":"aaf3e083-eba2-4025-935b-682a3bc38b28","paragraphs":["To perform static tag insertion, simply copy and paste the tags generated by the console or constructed manually into the source of your web page.","Example: insertion of a web tracking tag on a page displaying a form.","<html>\n  <...>\n  <body>\n  <script>\n      document.write(\"<img height='0' width='0' alt='' src='https://localhost/r/\" + Math.random().toString() + \"?tagid=home'>\");\n    </script>\n    <noscript>\n     <img height='0' width='0' alt='' src='https://localhost/r/?tagid=home'>\n    </noscript>\n    <h1>My site</h1>\n    <form action=\"http://localhost/amount.md\">\n      Quantity: <input type=\"text\" name=\"quantity\"/><br/><br/>\n      Amount: <input type=\"text\" name=\"amount\"/><br/><br/>\n      <input value=\"Save\" type=\"submit\">\n    </form>\n  </body>\n</html>","Insertion of a TRANSACTION-type web tracking tag in the confirmation page (\"amount.md\").","<html>\n  <body>\n    <script>\n      function getURLparam(name) \n      {\n        var m = location.search.match new RegExp(\"[?&]\" + name + \"=([^&]+)\"));\n        return m ? unescape(m[1]) : \"\";\n      }\n \n       var params = \"https://localhost/r/\" + Math.random().toString() + \"?tagid=amount&amount=\"\n                      +getURLparam(\"amount\")+\"&article=\"+getURLparam(\"quantity\");\n       document.write(\"<img height='0' width='0' src='\"+params+\"'/>\");\n    </script>","<h1>Approval confirmation</h1>\n  </body>\n</html>"]},{"section":"Dynamic generation of web tracking tags","sectionId":"9ab564a2-bf92-4c51-a054-af8dbfa396dd","paragraphs":["When your web pages are generated dynamically, you can add the web tracking tag at page generation time.","Example: Web tracking added to JSPs.","<%@page import=\"java.util.Random\" %>\n<html>\n  <body>\n    <img height='0' width='0' alt='' src='https://localhost/r/<%=new Random().nextInt()%>?tagid=home'>\n    <h1>My site</h1>\n    <form action=\"https://localhost/amount.md\">\n      Quantity: <input type=\"text\" name=\"quantity\"/><br/><br/>\n      Amount: <input type=\"text\" name=\"amount\"/><br/><br/>\n      <input value=\"Save\" type=\"submit\">\n    </form>\n  </body>\n</html>","<%@page import=\"java.util.Random\" %>\n<html>\n  <body>\n    <%  \n      String strParams = new Random().nextInt() + \"?tagid=amount\";\n      strParams += \"&amount=\"+request.getParameter(\"amount\");\n      strParams += \"&article=\"+request.getParameter(\"quantity\");\n    %>\n    <img height='0' width='0' alt=''\n     src='http://localhost/r/<%=strParams%>'>\n    <h1>Approval confirmation</h1>\n    </body>\n</html>"]},{"section":"Optimum method","sectionId":"48df5824-0a94-450e-96ec-3effdb2faea7","paragraphs":["If you wish to control the information sent to the redirection server, the most reliable way is to perform the HTTP query synchronously yourself using a page generating language.","The URL you construct must obey the syntax rules defined in Web tracking tag: definition.","NOTE","Redirection and web tracking use cookies, and it is important that the web server performing the synchronous HTTP call be in the same domain as the redirection server. The various HTTP exchanges must convey the 'id', 'uuid', and 'uuid230' cookies.","Example: Dynamic generation in Java, with recipient authentication using their account number.","[...]\n  // Recipient account, amount and articles\n  String strAccount = request.getParameter(\"account\");\n  String strAmount = request.getParameter(\"amount\");\n  String strArticle = request.getParameter(\"article\");","StringBuffer strCookies = new StringBuffer();\n  String strSetCookie = null;","// Get cookies from client request\n  Cookie[] cookies = request.getCookies();\n  for(int i=0; i< cookies.length; i++ )\n  {\n    Cookie c = cookies[i];\n    String strName = c.getName();\n    if( strName.equals(\"id\") || strName.equals(\"uuid\") || strName.equals(\"uuid230\") )\n      // Helper function to add cookies in string\n      AddCookie(strCookies, c);\n  }\n  // Now perform a synchronous HTTP request to inform redirection server\n  // Add a tagid in auto-discover mode, and a default jobId to use (in hexa)\n  StringBuffer strURL = new StringBuffer(\"https://www.adobe.com/r/a?tagid=cmd_page%7Ct&jobid=27EE\");\n  if( strAccount != null )\n    AddParameter(strURL, \"rcpid\", \"saccount=\"+strAccount);\n  if( strAmount != null )\n    AddParameter(strURL, \"amount\", strAmount);\n  if( strArticle != null )\n    AddParameter(strURL, \"article\", strArticle);\n  \n  URL url = new URL(strURL.toString());\n  HttpURLConnection connection = (HttpURLConnection)url.openConnection();\n  // Add the client cookies\n  if( strCookies.length() > 0 )\n    connection.setRequestProperty(\"Cookie\", strCookies.toString());","int errcode = connection.getResponseCode();","// Now add the Adobe Campaign cookies if the server returned one :\n  if( errcode == 200 )\n  {\n    strSetCookie = connection.getHeaderField(\"Set-Cookie\");\n    if( strSetCookie != null && strSetCookie.length() > 0 )\n      response.addHeader(\"Set-Cookie\", strSetCookie);\n  }\n  [...]"]}]}