{"guid":"476d60bb-d5d3-4da1-a80a-c4e29a94893c","title":"Enrich data","path":"help\\workflow\\using\\enriching-data.md","fullText":"---\nproduct: campaign\ntitle: Enrich data\ndescription: Learn more about the Enrichment workflow activity\nfeature: Workflows, Enrichment Activity\nexl-id: ab786cf1-74a4-4185-a63d-84e776a2f776\n---\n# Enrich data{#enriching-data}\n\n\n\n## About enriching data {#about-enriching-data}\n\nThis use case details possible uses of the **[!UICONTROL Enrichment]** activity in a targeting workflow. For more on using the **[!UICONTROL Enrichment]** activity, refer to: [Enrichment](enrichment.md).\n\nA use case on how to enrich an email delivery with custom dates is also available in [this section](email-enrichment-with-custom-date-fields.md).\n\nThe contacts in the marketing database are sent an invitation to take part in a competition via a web application. The results of the competition are recovered in the **[!UICONTROL Competition results]** table. This table is linked to the contact table (**[!UICONTROL Recipients]**). The **[!UICONTROL Competition results]** table contains the following fields:\n\n* Competition name (@game)\n* Trial number (@trial)\n* Score (@score)\n\n![](assets/uc1_enrich_1.png)\n\nA contact found in the **[!UICONTROL Recipients]** table can be linked to several lines in the **[!UICONTROL Competition results]** table. The relationship between these two tables is of 1-n type. Here is an example of the result logs for a recipient:\n\n![](assets/uc1_enrich_2.png)\n\nThe purpose of this use case it to send personalized deliveries to people who took part in the latest competition depending on their highest scores. The recipient with the highest score gets first prize, the recipient with the second highest score gets a consolation prize and all the others get a message wishing them better luck next time.\n\nTo set up this use case, we created the following targeting workflow:\n\n![](assets/uc1_enrich_3.png)\n\nTo create the workflow, apply the following steps:\n\n1. Two **[!UICONTROL Query]** activities and one **[!UICONTROL Intersection]** activity are added to target new subscribers who entered last the competition. \n1. The **[!UICONTROL Enrichment]** activity enables us to add data stored in the **[!UICONTROL Competition results]** table. The **[!UICONTROL Score]** field which our delivery personalization will take place on is added to the work table of the workflow. \n1. The **[!UICONTROL Split]** type activity enables us to create recipient subsets based on scores.\n1. For each subset, a **[!UICONTROL Delivery]** type activity is added.\n\n## Step 1: Targeting {#step-1--targeting}\n\nThe first query enables us to target recipients who were added to the database within the last six months.\n\n![](assets/uc1_enrich_4.png)\n\nThe second query enables us to target the recipients who took part in the last competition.\n\n![](assets/uc1_enrich_5.png)\n\nAn **[!UICONTROL Intersection]** type activity is then added to target the recipients added to the database within the last six months and who entered the last competition.\n\n## Step 2: Enrichment {#step-2--enrichment}\n\nIn this example, we want to personalize deliveries according to the **[!UICONTROL Score]** field stored in the **[!UICONTROL Competition results]** table. This table has a 1-n type relationship with the recipients table. The **[!UICONTROL Enrichment]** activity enables us to add data from a table linked to the filtering dimension to the work table of the workflow.\n\n1. In the editing screen of the enrichment activity, select **[!UICONTROL Add data]**, then **[!UICONTROL Data linked to the filtering dimension]** and click **[!UICONTROL Next]**.\n\n   ![](assets/uc1_enrich_6.png)\n\n1. Then select the **[!UICONTROL Data linked to the filtering dimension]** option, select the **[!UICONTROL Competition results]** table and click **[!UICONTROL Next]**.\n\n   ![](assets/uc1_enrich_7.png)\n\n1. Enter an ID and a label, and select the **[!UICONTROL Limit the line count]** option in the **[!UICONTROL Data collected]** field. In the **[!UICONTROL Lines to retrieve]** field, select '1' as a value. For each recipient, the enrichment activity will add a single line from the **[!UICONTROL Competition results]** table to the work table of the workflow. Click **[!UICONTROL Next]**.\n\n   ![](assets/uc1_enrich_8.png)\n\n1. In this example, we want to recover the recipient's highest score, but only for the last competition. To do this, add a filter to the **[!UICONTROL Competition name]** field to exclude all lines related to previous competitions. Click **[!UICONTROL Next]**.\n\n   ![](assets/uc1_enrich_9.png)\n\n1. Go to the **[!UICONTROL Sort]** screen and click the **[!UICONTROL Add]** button, select the **[!UICONTROL Score]** field and check the box in the **[!UICONTROL descending]** column to sort items of the **[!UICONTROL Score]** fields in descending order. For each recipient, the enrichment activity adds a line that matches the highest score for the last game. Click **[!UICONTROL Next]**.\n\n   ![](assets/uc1_enrich_10.png)\n\n1. In the **[!UICONTROL Data to add]** window, double-click the **[!UICONTROL Score]** field. For each recipient, the enrichment activity will add only the **[!UICONTROL Score]** field. Click **[!UICONTROL Finish]**.\n\n   ![](assets/uc1_enrich_11.png)\n\nRight-click the inbound transition of the enrichment activity and select **[!UICONTROL Display the target]**. The work table contains the following data:\n\n![](assets/uc1_enrich_13.png)\n\nThe linked schema is:\n\n![](assets/uc1_enrich_15.png)\n\nRenew this operation on the outbound transition of the enrichment activity. We can see that the data linked to the recipient scores has been added. The highest score of each recipient has been recovered.\n\n![](assets/uc1_enrich_12.png)\n\nThe matching schema has also been enriched.\n\n![](assets/uc1_enrich_14.png)\n\n## Step 3: Split and delivery {#step-3--split-and-delivery}\n\nTo sort the recipients based on their scores, a **[!UICONTROL Split]** activity is added after the enrichment. \n\n![](assets/uc1_enrich_18.png)\n\n1. A first (**Winner**) subset has been defined to include the recipient with the highest score. To do this, define a limitation of the number of records, apply a descending sort to the score, and limit the number of records to 1.\n\n   ![](assets/uc1_enrich_16.png)\n\n1. The second (**Second place**) subset includes the recipient with the second highest score. Configuration is the same as for the first subset.\n\n   ![](assets/uc1_enrich_17.png)\n\n1. The third (**losers**) subset contains all other recipients. Go to the **[!UICONTROL General]** tab and check the **[!UICONTROL Generate complement]** box to target all recipients who did not achieve the two highest scores.\n\n   ![](assets/uc1_enrich_19.png)\n\n1. Add a **[!UICONTROL Delivery]** type activity for each subset, using a different delivery template for each.\n\n   ![](assets/uc1_enrich_20.png)\n","headers":[["title","Enrich data"],["description","Learn more about the Enrichment workflow activity"],["feature","Workflows, Enrichment Activity"]],"sections":[{"section":"Enrich data","sectionId":"58396e4e-2aeb-41b8-9106-c61c29599b86","paragraphs":[]},{"section":"About enriching data","sectionId":"de1046fb-e3ef-43d3-8dfb-e55a1a29f272","paragraphs":["This use case details possible uses of the Enrichment activity in a targeting workflow. For more on using the Enrichment activity, refer to: Enrichment.","A use case on how to enrich an email delivery with custom dates is also available in this section.","The contacts in the marketing database are sent an invitation to take part in a competition via a web application. The results of the competition are recovered in the Competition results table. This table is linked to the contact table (Recipients). The Competition results table contains the following fields:","Competition name (@game)\nTrial number (@trial)\nScore (@score)","A contact found in the Recipients table can be linked to several lines in the Competition results table. The relationship between these two tables is of 1-n type. Here is an example of the result logs for a recipient:","The purpose of this use case it to send personalized deliveries to people who took part in the latest competition depending on their highest scores. The recipient with the highest score gets first prize, the recipient with the second highest score gets a consolation prize and all the others get a message wishing them better luck next time.","To set up this use case, we created the following targeting workflow:","To create the workflow, apply the following steps:","Two Query activities and one Intersection activity are added to target new subscribers who entered last the competition. \nThe Enrichment activity enables us to add data stored in the Competition results table. The Score field which our delivery personalization will take place on is added to the work table of the workflow. \nThe Split type activity enables us to create recipient subsets based on scores.\nFor each subset, a Delivery type activity is added."]},{"section":"Step 1: Targeting","sectionId":"9e807a89-7e1c-4b4b-b880-d751131e8a4a","paragraphs":["The first query enables us to target recipients who were added to the database within the last six months.","The second query enables us to target the recipients who took part in the last competition.","An Intersection type activity is then added to target the recipients added to the database within the last six months and who entered the last competition."]},{"section":"Step 2: Enrichment","sectionId":"3117a410-0306-490a-af15-a0258706b7fe","paragraphs":["In this example, we want to personalize deliveries according to the Score field stored in the Competition results table. This table has a 1-n type relationship with the recipients table. The Enrichment activity enables us to add data from a table linked to the filtering dimension to the work table of the workflow.","In the editing screen of the enrichment activity, select Add data, then Data linked to the filtering dimension and click Next.","Then select the Data linked to the filtering dimension option, select the Competition results table and click Next.","Enter an ID and a label, and select the Limit the line count option in the Data collected field. In the Lines to retrieve field, select '1' as a value. For each recipient, the enrichment activity will add a single line from the Competition results table to the work table of the workflow. Click Next.","In this example, we want to recover the recipient's highest score, but only for the last competition. To do this, add a filter to the Competition name field to exclude all lines related to previous competitions. Click Next.","Go to the Sort screen and click the Add button, select the Score field and check the box in the descending column to sort items of the Score fields in descending order. For each recipient, the enrichment activity adds a line that matches the highest score for the last game. Click Next.","In the Data to add window, double-click the Score field. For each recipient, the enrichment activity will add only the Score field. Click Finish.","Right-click the inbound transition of the enrichment activity and select Display the target. The work table contains the following data:","The linked schema is:","Renew this operation on the outbound transition of the enrichment activity. We can see that the data linked to the recipient scores has been added. The highest score of each recipient has been recovered.","The matching schema has also been enriched."]},{"section":"Step 3: Split and delivery","sectionId":"c62aec2d-2b8d-4b1b-b89a-843a5a9261de","paragraphs":["To sort the recipients based on their scores, a Split activity is added after the enrichment.","A first (Winner) subset has been defined to include the recipient with the highest score. To do this, define a limitation of the number of records, apply a descending sort to the score, and limit the number of records to 1.","The second (Second place) subset includes the recipient with the second highest score. Configuration is the same as for the first subset.","The third (losers) subset contains all other recipients. Go to the General tab and check the Generate complement box to target all recipients who did not achieve the two highest scores.","Add a Delivery type activity for each subset, using a different delivery template for each."]}]}